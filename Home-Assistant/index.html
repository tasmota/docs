<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Everything about using Tasmota in Home Assistant"><link href=https://tasmota.github.io/docs/Home-Assistant/ rel=canonical><link href=../Domoticz/ rel=prev><link href=../Homebridge/ rel=next><link rel=icon href=../_media/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.23"><title>Home Assistant - Tasmota</title><link rel=stylesheet href=../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Barlow:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Barlow";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/css/anchor-fix.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-8J08F8X90S"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-8J08F8X90S",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-8J08F8X90S",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#home-assistant class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title=Tasmota class="md-header__button md-logo" aria-label=Tasmota data-md-component=logo> <img src=../_media/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Tasmota </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Home Assistant </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue data-md-color-accent=deep-purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/arendst/tasmota title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> arendst/tasmota </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../Features/ class=md-tabs__link> Features </a> </li> <li class=md-tabs__item> <a href=../ESP32/ class=md-tabs__link> ESP32 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../Integrations/ class=md-tabs__link> Smart Home Integrations </a> </li> <li class=md-tabs__item> <a href=../Supported-Peripherals/ class=md-tabs__link> Peripherals </a> </li> <li class=md-tabs__item> <a href=../Configuration-Procedure-for-New-Devices/ class=md-tabs__link> Supported Devices </a> </li> <li class=md-tabs__item> <a href=../FAQ/ class=md-tabs__link> Help </a> </li> <li class=md-tabs__item> <a href=http://tasmota.github.io/install class=md-tabs__link> Web Installer </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=Tasmota class="md-nav__button md-logo" aria-label=Tasmota data-md-component=logo> <img src=../_media/logo.svg alt=logo> </a> Tasmota </label> <div class=md-nav__source> <a href=https://github.com/arendst/tasmota title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> arendst/tasmota </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> News </span> </a> </li> <li class=md-nav__item> <a href=../About/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class=md-nav__item> <a href=../Getting-Started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../Upgrading/ class=md-nav__link> <span class=md-ellipsis> Upgrading </span> </a> </li> <li class=md-nav__item> <a href=../MQTT/ class=md-nav__link> <span class=md-ellipsis> MQTT </span> </a> </li> <li class=md-nav__item> <a href=../Commands/ class=md-nav__link> <span class=md-ellipsis> Commands </span> </a> </li> <li class=md-nav__item> <a href=../Templates/ class=md-nav__link> <span class=md-ellipsis> Templates </span> </a> </li> <li class=md-nav__item> <a href=../Components/ class=md-nav__link> <span class=md-ellipsis> Components </span> </a> </li> <li class=md-nav__item> <a href=../Modules/ class=md-nav__link> <span class=md-ellipsis> Modules </span> </a> </li> <li class=md-nav__item> <a href=../Peripherals/ class=md-nav__link> <span class=md-ellipsis> Peripherals </span> </a> </li> <li class=md-nav__item> <a href=../WebUI/ class=md-nav__link> <span class=md-ellipsis> WebUI </span> </a> </li> <li class=md-nav__item> <a href=../Firmware-Builds/ class=md-nav__link> <span class=md-ellipsis> Firmware Builds </span> </a> </li> <li class=md-nav__item> <a href=../Compile-your-build/ class=md-nav__link> <span class=md-ellipsis> Compiling </span> </a> </li> <li class=md-nav__item> <a href=../Contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../Download/ class=md-nav__link> <span class=md-ellipsis> Download </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/arendst/Tasmota/discussions/categories/show-and-tell class=md-nav__link> <span class=md-ellipsis> Project Showcase </span> </a> </li> <li class=md-nav__item> <a href=../For-Developers/ class=md-nav__link> <span class=md-ellipsis> For Developers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Features/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../ADC/ class=md-nav__link> <span class=md-ellipsis> Analog Pin </span> </a> </li> <li class=md-nav__item> <a href=../ArtNet/ class=md-nav__link> <span class=md-ellipsis> ArtNet DMX </span> </a> </li> <li class=md-nav__item> <a href=../Buttons-and-Switches/ class=md-nav__link> <span class=md-ellipsis> Buttons and Switches </span> </a> </li> <li class=md-nav__item> <a href=../DeepSleep/ class=md-nav__link> <span class=md-ellipsis> DeepSleep </span> </a> </li> <li class=md-nav__item> <a href=../Device-Groups/ class=md-nav__link> <span class=md-ellipsis> Device Groups </span> </a> </li> <li class=md-nav__item> <a href=../Universal-Display-Driver/ class=md-nav__link> <span class=md-ellipsis> Universal Display and Universal Touch drivers (uDisplay/uTouch) </span> </a> </li> <li class=md-nav__item> <a href=../Displays/ class=md-nav__link> <span class=md-ellipsis> Displays </span> </a> </li> <li class=md-nav__item> <a href=../Dynamic-Sleep/ class=md-nav__link> <span class=md-ellipsis> Dynamic Sleep </span> </a> </li> <li class=md-nav__item> <a href=../I2CDEVICES/ class=md-nav__link> <span class=md-ellipsis> I2C Devices </span> </a> </li> <li class=md-nav__item> <a href=../I2S-Audio/ class=md-nav__link> <span class=md-ellipsis> I2S Audio </span> </a> </li> <li class=md-nav__item> <a href=../IPv6/ class=md-nav__link> <span class=md-ellipsis> IPv6 </span> </a> </li> <li class=md-nav__item> <a href=../Lights/ class=md-nav__link> <span class=md-ellipsis> Lights </span> </a> </li> <li class=md-nav__item> <a href=../Matter/ class=md-nav__link> <span class=md-ellipsis> Matter </span> </a> </li> <li class=md-nav__item> <a href=../PIR-Motion-Sensors/ class=md-nav__link> <span class=md-ellipsis> PIR Motion Sensors </span> </a> </li> <li class=md-nav__item> <a href=../Power-Monitoring-Calibration/ class=md-nav__link> <span class=md-ellipsis> Power Monitoring Calibration </span> </a> </li> <li class=md-nav__item> <a href=../PWM-dimmer-switch/ class=md-nav__link> <span class=md-ellipsis> PWM Dimmer </span> </a> </li> <li class=md-nav__item> <a href=../Rules/ class=md-nav__link> <span class=md-ellipsis> Rules </span> </a> </li> <li class=md-nav__item> <a href=../Scripting-Language/ class=md-nav__link> <span class=md-ellipsis> Scripting Language </span> </a> </li> <li class=md-nav__item> <a href=../Blinds-and-Shutters/ class=md-nav__link> <span class=md-ellipsis> Shutters and Blinds </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_21> <label class=md-nav__link for=__nav_2_21 id=__nav_2_21_label tabindex=0> <span class=md-ellipsis> Protocol Bridging </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_21_label aria-expanded=false> <label class=md-nav__title for=__nav_2_21> <span class="md-nav__icon md-icon"></span> Protocol Bridging </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../TasmotaClient/ class=md-nav__link> <span class=md-ellipsis> Arduino MCU </span> </a> </li> <li class=md-nav__item> <a href=../Bluetooth/ class=md-nav__link> <span class=md-ellipsis> BLE Gateway </span> </a> </li> <li class=md-nav__item> <a href=../DALI/ class=md-nav__link> <span class=md-ellipsis> DALI </span> </a> </li> <li class=md-nav__item> <a href=../HDMI_CEC/ class=md-nav__link> <span class=md-ellipsis> HDMI CEC </span> </a> </li> <li class=md-nav__item> <a href=../Tasmota-IR/ class=md-nav__link> <span class=md-ellipsis> IR Communication </span> </a> </li> <li class=md-nav__item> <a href=../Projector/ class=md-nav__link> <span class=md-ellipsis> LCD/DLP Projector Control </span> </a> </li> <li class=md-nav__item> <a href=../LoRa-and-LoRaWan-Bridge/ class=md-nav__link> <span class=md-ellipsis> LoRa and LoRaWan Bridge </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Bridge/ class=md-nav__link> <span class=md-ellipsis> Modbus Bridge </span> </a> </li> <li class=md-nav__item> <a href=../OpenTherm/ class=md-nav__link> <span class=md-ellipsis> OpenTherm </span> </a> </li> <li class=md-nav__item> <a href=../RF-Protocol/ class=md-nav__link> <span class=md-ellipsis> RF Communication </span> </a> </li> <li class=md-nav__item> <a href=../Serial-to-TCP-Bridge/ class=md-nav__link> <span class=md-ellipsis> Serial to TCP Bridge </span> </a> </li> <li class=md-nav__item> <a href=../TWAI/ class=md-nav__link> <span class=md-ellipsis> TWAI </span> </a> </li> <li class=md-nav__item> <a href=../Telegram/ class=md-nav__link> <span class=md-ellipsis> Telegram </span> </a> </li> <li class=md-nav__item> <a href=../Zigbee/ class=md-nav__link> <span class=md-ellipsis> Zigbee </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Smart-Meter-Interface/ class=md-nav__link> <span class=md-ellipsis> Smart Meter Interface </span> </a> </li> <li class=md-nav__item> <a href=../Thermostat/ class=md-nav__link> <span class=md-ellipsis> Thermostat </span> </a> </li> <li class=md-nav__item> <a href=../Timers/ class=md-nav__link> <span class=md-ellipsis> Timers </span> </a> </li> <li class=md-nav__item> <a href=../TLS/ class=md-nav__link> <span class=md-ellipsis> TLS Secured MQTT </span> </a> </li> <li class=md-nav__item> <a href=../TuyaMCU/ class=md-nav__link> <span class=md-ellipsis> TuyaMCU </span> </a> </li> <li class=md-nav__item> <a href=../UFS/ class=md-nav__link> <span class=md-ellipsis> Universal File System </span> </a> </li> <li class=md-nav__item> <a href=../Range-Extender/ class=md-nav__link> <span class=md-ellipsis> Wi-Fi Range Extender </span> </a> </li> <li class=md-nav__item> <a href=../Wireguard/ class=md-nav__link> <span class=md-ellipsis> Wireguard VPN </span> </a> </li> <li class=md-nav__item> <a href=../Tutorials/ class=md-nav__link> <span class=md-ellipsis> Projects and Tutorials </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> ESP32 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> ESP32 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ESP32/ class=md-nav__link> <span class=md-ellipsis> Tasmota32 Features </span> </a> </li> <li class=md-nav__item> <a href=../Berry/ class=md-nav__link> <span class=md-ellipsis> Berry </span> </a> </li> <li class=md-nav__item> <a href=../Bluetooth_ESP32/ class=md-nav__link> <span class=md-ellipsis> Bluetooth Low Energy </span> </a> </li> <li class=md-nav__item> <a href=../LVGL/ class=md-nav__link> <span class=md-ellipsis> LVGL </span> </a> </li> <li class=md-nav__item> <a href=../HASPmota/ class=md-nav__link> <span class=md-ellipsis> HASPmota </span> </a> </li> <li class=md-nav__item> <a href=../Matter/ class=md-nav__link> <span class=md-ellipsis> Matter </span> </a> </li> <li class=md-nav__item> <a href=../Tasmota-Extension/ class=md-nav__link> <span class=md-ellipsis> Tasmota Extension </span> </a> </li> <li class=md-nav__item> <a href=../Tasmota-Application/ class=md-nav__link> <span class=md-ellipsis> Tasmota Application Files </span> </a> </li> <li class=md-nav__item> <a href=../TFL/ class=md-nav__link> <span class=md-ellipsis> TensorFlow Lite </span> </a> </li> <li class=md-nav__item> <a href=../TouchPin/ class=md-nav__link> <span class=md-ellipsis> Touch GPIOs </span> </a> </li> <li class=md-nav__item> <a href=../Safeboot/ class=md-nav__link> <span class=md-ellipsis> Safeboot Partition Layout </span> </a> </li> <li class=md-nav__item> <a href=https://templates.blakadder.com/esp32 class=md-nav__link> <span class=md-ellipsis> Supported Devices </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Smart Home Integrations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Smart Home Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Integrations/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../Alexa/ class=md-nav__link> <span class=md-ellipsis> Alexa </span> </a> </li> <li class=md-nav__item> <a href=../AWS-IoT/ class=md-nav__link> <span class=md-ellipsis> AWS IoT </span> </a> </li> <li class=md-nav__item> <a href=../Domoticz/ class=md-nav__link> <span class=md-ellipsis> Domoticz </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Home Assistant </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Home Assistant </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#tasmota-integration class=md-nav__link> <span class=md-ellipsis> Tasmota Integration </span> </a> <nav class=md-nav aria-label="Tasmota Integration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#supported-entities class=md-nav__link> <span class=md-ellipsis> Supported Entities </span> </a> </li> <li class=md-nav__item> <a href=#removing-devices class=md-nav__link> <span class=md-ellipsis> Removing devices </span> </a> </li> <li class=md-nav__item> <a href=#supplemental-custom-discovery-message class=md-nav__link> <span class=md-ellipsis> Supplemental Custom Discovery Message </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#editing-configurationyaml class=md-nav__link> <span class=md-ellipsis> Editing configuration.yaml </span> </a> <nav class=md-nav aria-label="Editing configuration.yaml"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#switches class=md-nav__link> <span class=md-ellipsis> Switches </span> </a> </li> <li class=md-nav__item> <a href=#lights class=md-nav__link> <span class=md-ellipsis> Lights </span> </a> </li> <li class=md-nav__item> <a href=#sensors class=md-nav__link> <span class=md-ellipsis> Sensors </span> </a> </li> <li class=md-nav__item> <a href=#power-monitoring class=md-nav__link> <span class=md-ellipsis> Power Monitoring </span> </a> </li> <li class=md-nav__item> <a href=#binary-sensors class=md-nav__link> <span class=md-ellipsis> Binary Sensors </span> </a> </li> <li class=md-nav__item> <a href=#fans class=md-nav__link> <span class=md-ellipsis> Fans </span> </a> </li> <li class=md-nav__item> <a href=#covers class=md-nav__link> <span class=md-ellipsis> Covers </span> </a> </li> <li class=md-nav__item> <a href=#climate class=md-nav__link> <span class=md-ellipsis> Climate </span> </a> </li> <li class=md-nav__item> <a href=#device-specific class=md-nav__link> <span class=md-ellipsis> Device Specific </span> </a> </li> <li class=md-nav__item> <a href=#zigbee-devices class=md-nav__link> <span class=md-ellipsis> Zigbee Devices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#useful-automations class=md-nav__link> <span class=md-ellipsis> Useful Automations </span> </a> </li> <li class=md-nav__item> <a href=#mqtt-discovery-removed class=md-nav__link> <span class=md-ellipsis> MQTT Discovery REMOVED </span> </a> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Homebridge/ class=md-nav__link> <span class=md-ellipsis> Homebridge </span> </a> </li> <li class=md-nav__item> <a href=https://homey.app/en-us/app/com.paveld.tasmota/Tasmota-MQTT/ class=md-nav__link> <span class=md-ellipsis> Homey </span> </a> </li> <li class=md-nav__item> <a href=../HomeSeer/ class=md-nav__link> <span class=md-ellipsis> HomeSeer </span> </a> </li> <li class=md-nav__item> <a href=../IP-Symcon/ class=md-nav__link> <span class=md-ellipsis> IP Symcon </span> </a> </li> <li class=md-nav__item> <a href=../KNX/ class=md-nav__link> <span class=md-ellipsis> KNX </span> </a> </li> <li class=md-nav__item> <a href=../NodeRed/ class=md-nav__link> <span class=md-ellipsis> NodeRed </span> </a> </li> <li class=md-nav__item> <a href=../nymea/ class=md-nav__link> <span class=md-ellipsis> nymea </span> </a> </li> <li class=md-nav__item> <a href=../Octoprint/ class=md-nav__link> <span class=md-ellipsis> OctoPrint </span> </a> </li> <li class=md-nav__item> <a href=../openHAB/ class=md-nav__link> <span class=md-ellipsis> openHAB </span> </a> </li> <li class=md-nav__item> <a href=../otto/ class=md-nav__link> <span class=md-ellipsis> Otto </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/arendst/Tasmota/issues/3769 class=md-nav__link> <span class=md-ellipsis> IOBroker </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/tim-hellhake/tasmota-adapter class=md-nav__link> <span class=md-ellipsis> Mozilla WebThings Adapter </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/hongtat/tasmota-connect class=md-nav__link> <span class=md-ellipsis> SmartThings </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/Gifford47/tasmohab/blob/master/README.md class=md-nav__link> <span class=md-ellipsis> Tasmohab </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Supported-Peripherals/ class=md-nav__link> <span class=md-ellipsis> Peripherals </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Supported Devices </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Supported Devices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Configuration-Procedure-for-New-Devices/ class=md-nav__link> <span class=md-ellipsis> Configure Unknown Device </span> </a> </li> <li class=md-nav__item> <a href="https://templates.blakadder.com/ " target='_blank""' class=md-nav__link> <span class=md-ellipsis> All Supported Devices </span> </a> </li> <li class=md-nav__item> <a href=../Pinouts/ class=md-nav__link> <span class=md-ellipsis> Wi-Fi Module Pinouts </span> </a> </li> <li class=md-nav__item> <a href=../Supported-Modules/ class=md-nav__link> <span class=md-ellipsis> Supported Modules </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Help </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Help </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../FAQ/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class=md-nav__item> <a href=../Troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> <li class=md-nav__item> <a href=../Device-Recovery/ class=md-nav__link> <span class=md-ellipsis> Device Recovery </span> </a> </li> <li class=md-nav__item> <a href="https://discord.gg/Ks2Kzd4 " target='_blank""' class=md-nav__link> <span class=md-ellipsis> Discord Support </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=http://tasmota.github.io/install class=md-nav__link> <span class=md-ellipsis> Web Installer </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#tasmota-integration class=md-nav__link> <span class=md-ellipsis> Tasmota Integration </span> </a> <nav class=md-nav aria-label="Tasmota Integration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#supported-entities class=md-nav__link> <span class=md-ellipsis> Supported Entities </span> </a> </li> <li class=md-nav__item> <a href=#removing-devices class=md-nav__link> <span class=md-ellipsis> Removing devices </span> </a> </li> <li class=md-nav__item> <a href=#supplemental-custom-discovery-message class=md-nav__link> <span class=md-ellipsis> Supplemental Custom Discovery Message </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#editing-configurationyaml class=md-nav__link> <span class=md-ellipsis> Editing configuration.yaml </span> </a> <nav class=md-nav aria-label="Editing configuration.yaml"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#switches class=md-nav__link> <span class=md-ellipsis> Switches </span> </a> </li> <li class=md-nav__item> <a href=#lights class=md-nav__link> <span class=md-ellipsis> Lights </span> </a> </li> <li class=md-nav__item> <a href=#sensors class=md-nav__link> <span class=md-ellipsis> Sensors </span> </a> </li> <li class=md-nav__item> <a href=#power-monitoring class=md-nav__link> <span class=md-ellipsis> Power Monitoring </span> </a> </li> <li class=md-nav__item> <a href=#binary-sensors class=md-nav__link> <span class=md-ellipsis> Binary Sensors </span> </a> </li> <li class=md-nav__item> <a href=#fans class=md-nav__link> <span class=md-ellipsis> Fans </span> </a> </li> <li class=md-nav__item> <a href=#covers class=md-nav__link> <span class=md-ellipsis> Covers </span> </a> </li> <li class=md-nav__item> <a href=#climate class=md-nav__link> <span class=md-ellipsis> Climate </span> </a> </li> <li class=md-nav__item> <a href=#device-specific class=md-nav__link> <span class=md-ellipsis> Device Specific </span> </a> </li> <li class=md-nav__item> <a href=#zigbee-devices class=md-nav__link> <span class=md-ellipsis> Zigbee Devices </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#useful-automations class=md-nav__link> <span class=md-ellipsis> Useful Automations </span> </a> </li> <li class=md-nav__item> <a href=#mqtt-discovery-removed class=md-nav__link> <span class=md-ellipsis> MQTT Discovery REMOVED </span> </a> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/tasmota/docs/blob/master/docs/Home-Assistant.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <h1 id=home-assistant>Home Assistant<a class=headerlink href=#home-assistant title="Permanent link">~</a></h1> <p><a href=https://home-assistant.io/ >Home Assistant</a> is an open source home automation solution that puts local control and privacy first.</p> <p>Tasmota communicates with Home Assistant using MQTT. Before going any further, make sure MQTT is properly set up in <a href=https://www.home-assistant.io/integrations/mqtt/ >Home Assistant</a> and <a href=../MQTT/ >Tasmota</a>. </p> <p>Home Assistant can add Tasmota devices using:</p> <ol> <li>Official Tasmota integration - <strong>preferred</strong> and automatic instant discovery of entities</li> <li>Manual configuration by editing configuration.yaml - recommended for marginal use cases, e.g., TuyaMCU fan devices</li> </ol> <h2 id=tasmota-integration>Tasmota Integration<a class=headerlink href=#tasmota-integration title="Permanent link">~</a></h2> <p><a href="https://my.home-assistant.io/redirect/config_flow_start/?domain=Tasmota"><img alt="Open your Home Assistant instance and start setting up a new integration." src=https://my.home-assistant.io/badges/config_flow_start.svg></a></p> <p>Once you configure the <a href=https://www.home-assistant.io/integrations/tasmota/ >Home Assistant</a> integration every new Tasmota device with <code>SetOption19 0</code> set will be discovered automatically. </p> <p>All Tasmota devices will be listed in their own Tasmota card in <strong>Configuration - Integrations</strong> menu in Home Assistant.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Do not change the FullTopic in order to use this feature. Leave it as default.</p> </div> <p><img alt="Informative sensor" src=../_media/tasmota_integration_showcase.png></p> <p>Tasmota uses <a href=../Commands/#devicename><code>DeviceName</code></a> to name the device in Tasmota integration and <a href=../Commands/#friendlyname><code>FriendlyName&lt;x&gt;</code></a> to name power outputs (switch or light entities in HA). </p> <details class=tip> <summary>Use templates to change the Module name</summary> <p>Setting the <a href=../Templates/ >template</a> name will change the Module name as well which will be reflected in Home Assistant. This helps in identifying when dealing with a large number of devices. It's nicer than having 10 Sonoff S31's or a bunch of TuyaMCU's" <img alt="Template name as Module name in Home Assistant" src=../_media/templatemodule.png></p> </details> <div class="admonition bug"> <p class=admonition-title>Bug</p> <p>If you are using Home Assistant OS <a href=https://github.com/home-assistant/addons/tree/master/mosquitto>MQTT add-on</a> add the following to the ACL file (user section or general section): <code>topic write tasmota/discovery/#</code> to give Tasmota devices write access to the discovery topic.</p> </div> <h3 id=supported-entities>Supported Entities<a class=headerlink href=#supported-entities title="Permanent link">~</a></h3> <ul> <li>Lights as <code>light</code> entities.<br> Single channel Dimmers, RGB lights, RGB lights with Color Temperature control and RGB lights with White control are supported.</li> <li>Relays as <code>switch</code> entities With <a href=../Commands/#setoption30><code>SetOption30 1</code></a> all relays one the device will be added as light entities instead</li> <li>Sensors as <code>sensor</code> entities</li> <li>Switches as <code>binary_sensor</code> entities or <code>automation triggers</code> depending on <code>SwitchMode</code> used when <a href=../Commands/#setoption114><code>SetOption114 1</code></a></li> <li>Buttons as automation triggers when <a href=../Commands/#setoption73><code>SetOption73</code></a> is enabled</li> <li>Shutters as cover entities. Currently only shutter modes 1 to 4 are supported. Shutter mode 5 and Tuya shutters are not supported.</li> <li>Devices configured as iFan02 or iFan03 as fan entities. TuyaMCU fans are not supported.</li> <li>Each discovered device will by default add 8 disabled sensors. Enable the ones you need. You cannot delete them, they will simply be re-added on a restart.</li> </ul> <p>Types of devices not listed above still require <a href=#editing-configurationyaml>manual configuration</a>. </p> <p>If you're running Tasmota on ESP32 you can use <a href=https://github.com/fmtr/hct>Home Assistant Controls</a> in Berry to discover more complex entities (pull-down lists, number sliders, etc)</p> <div class="admonition warning"> <p class=admonition-title>Zigbee and Bluetooth devices paired in Tasmota will <strong>NOT</strong> be discovered in Home Assistant</p> </div> <!-- ### Transition from MQTT Discovery

If you have been using `SetOption19 1` for device discovery, setting it to `SetOption19 0` will remove your Tasmota device from the MQTT device list and add it to the Tasmota integration in HA. They will be treated as new entities in Home Assistant but if you previously used default values they will use the same entity_id as the MQTT discovery devices.
 --> <h3 id=removing-devices>Removing devices<a class=headerlink href=#removing-devices title="Permanent link">~</a></h3> <p>You cannot as long as Home Assistant support is enabled in your Tasmota binary. Disable the device in Home Assistant instead. </p> <p><img alt="Disable device" src=../_media/hatasmota_delete.png></p> <p>Deleting them from Home Assistant while Tasmota device is still active will eventually rediscover all the entities. </p> <!-- If you opt to switch to MQTT Discovery, issuing `SetOption19 1` command will remove all Tasmota entities and add new entities under the MQTT integration. --> <h3 id=supplemental-custom-discovery-message>Supplemental Custom Discovery Message<a class=headerlink href=#supplemental-custom-discovery-message title="Permanent link">~</a></h3> <p>You can use <a href=https://www.home-assistant.io/docs/mqtt/discovery/ >MQTT Discovery</a> in HA to add sensors and other entities that are not discovered through Tasmota integration and associate them with an already discovered device.</p> <p>When creating the MQTT discovery JSON add this device identifier <code>,"device":{"connections":[["mac","%macaddr%"]]}</code> where %macaddr% is the mac address of the device without <code>:</code>. When used in a rule variable <code>%macaddr%</code> will be replaced automatically.</p> <p>There are Home Assistant Blueprints for specific device types to create needed entities at out blueprints GitHub. Look for the icon in templates to one-click import the configuration automation.</p> <p><a href=https://github.com/tasmota/blueprints/ title=Blueprints><img loading=lazy src=https://templates.blakadder.com/assets/blueprint_import.svg></a></p> <p>Examples of creating custom discovery messages:</p> <ul> <li><a href=https://blakadder.com/tasmota-tags/ >RFID Tag</a></li> <li><a href=https://blakadder.com/pir-in-tasmota-integration/ >PIR sensor</a></li> <li><a href=https://blakadder.com/bw-af1-in-home-assistant/ >TuyaMCU Air Fryer</a></li> <li><a href=https://blakadder.com/tuya-climate/ >TuyaMCU Heater</a></li> </ul> <h2 id=editing-configurationyaml>Editing configuration.yaml<a class=headerlink href=#editing-configurationyaml title="Permanent link">~</a></h2> <p>Adding devices manually is done by editing the <code>configuration.yaml</code> file and adding appropriate blocks of yaml code to the corresponding section.</p> <div class="admonition note"> <p class=admonition-title>After every change to the configuration.yaml file you'll need to restart the MANUALLY CONFIGURED MQTT ENTITIES in <a href=https://my.home-assistant.io/redirect/server_controls/ >Server Controls</a> to apply the changes.</p> </div> <p>The advantage of manually configuring a device is that you maintain control of all aspects of the configuration.</p> <div class="admonition warning"> <p class=admonition-title>All the configurations are just examples.</p> </div> <p>You need to be familiar with Home Assistant's configuration structure and procedures. <br> Straight copy paste of the given examples into configuration.yaml will probably not work for you. </p> <p>If you are using a localized (non-english) version be sure to check the correct spelling and cases for values:</p> <ul> <li>'payload_available' </li> <li>'payload_not_available'</li> <li>'payload_on'</li> <li>'payload_off'</li> </ul> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>If you want the power states to be persistent in Tasmota and Home Assistant set <code>PowerRetain 1</code> instead of using <code>retain: true</code> in Home Assistant</p> </div> <div class="admonition warning"> <p class=admonition-title>When using <code>unique_id:</code> make sure it's unique to each entity</p> <p>When <code>unique_id</code> is set, Home Assistant will allow some entity customization from the UI such as changing the name or icon.</p> </div> <h3 id=switches>Switches<a class=headerlink href=#switches title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/switch.mqtt/ >MQTT Switch</a> integration.</p> <p><strong>Required Commands</strong> <br> <code>SetOption59 1</code> - enables sending of tele/%topic%/STATE on POWER and light related commands for faster updates</p> <div class="admonition example"> <p class=admonition-title>Single Switch</p> <p>If <a href=../Commands/#setoption26>SetOption26</a> is enabled, use <code>POWER1</code> instead of <code>POWER</code></p> </div> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>switch</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>unique_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasmota_switch</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Switch&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/RESULT&quot;</span><span class=w>  </span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
<span class=w>      </span><span class=nt>payload_on</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ON&quot;</span>
<span class=w>      </span><span class=nt>payload_off</span><span class=p>:</span><span class=w> </span><span class=s>&quot;OFF&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Multiple Switches</p> <p>When a device has more than one POWER output (multiple relays or a mix of relays and lights) use corresponding <code>POWER&lt;x&gt;</code> (<code>POWER1</code>, <code>POWER2</code>, etc)</p> </div> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>switch</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>unique_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tas_switch_1</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Switch</span><span class=nv> </span><span class=s>1&quot;</span>
<span class=w>    </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/RESULT&quot;</span><span class=w>  </span>
<span class=w>    </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER1</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>    </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/POWER1&quot;</span>
<span class=w>    </span><span class=nt>payload_on</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ON&quot;</span>
<span class=w>    </span><span class=nt>payload_off</span><span class=p>:</span><span class=w> </span><span class=s>&quot;OFF&quot;</span>
<span class=w>    </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>    </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>    </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>unique_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tas_switch_2</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Switch</span><span class=nv> </span><span class=s>2&quot;</span>
<span class=w>    </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/RESULT&quot;</span><span class=w>  </span>
<span class=w>    </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER2</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>    </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/POWER2&quot;</span>
<span class=w>    </span><span class=nt>payload_on</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ON&quot;</span>
<span class=w>    </span><span class=nt>payload_off</span><span class=p>:</span><span class=w> </span><span class=s>&quot;OFF&quot;</span>
<span class=w>    </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>    </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>    </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>unique_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tas_switch_3</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Switch</span><span class=nv> </span><span class=s>3&quot;</span>
<span class=w>    </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/RESULT&quot;</span><span class=w>  </span>
<span class=w>    </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER3</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>    </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/POWER3&quot;</span>
<span class=w>    </span><span class=nt>payload_on</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ON&quot;</span>
<span class=w>    </span><span class=nt>payload_off</span><span class=p>:</span><span class=w> </span><span class=s>&quot;OFF&quot;</span>
<span class=w>    </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>    </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>    </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>If you are using a switch device to control a light you may want to use <a href=https://www.home-assistant.io/components/light.mqtt/ ><code>MQTT Light</code></a> integration instead. </p> </div> <p>Simply replace <code>switch:</code> with <code>light:</code> in the configuration keeping everything else the same.</p> <h3 id=lights>Lights<a class=headerlink href=#lights title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/light.mqtt/ >MQTT Light</a> integration.</p> <p>All configurations require <code>SetOption59 1</code> - enables sending of tele/%topic%/STATE on POWER and light related commands</p> <p><strong>Optional Commands</strong> <br> <code>Fade on</code> - makes transitions smoother <br> <code>Speed 5</code> - set transition speed</p> <div class="admonition example"> <p class=admonition-title>Dimmer</p> </div> <p>Used for dimmers and dimmable lights (single channel lights).</p> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>light</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Dimmer&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>state_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{value_json.POWER}}&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>brightness_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Dimmer&quot;</span>
<span class=w>      </span><span class=nt>brightness_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>brightness_scale</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class=w>      </span><span class=nt>on_command_type</span><span class=p>:</span><span class=w> </span><span class=s>&quot;brightness&quot;</span>
<span class=w>      </span><span class=nt>brightness_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{value_json.Dimmer}}&quot;</span>
<span class=w>      </span><span class=nt>payload_on</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ON&quot;</span>
<span class=w>      </span><span class=nt>payload_off</span><span class=p>:</span><span class=w> </span><span class=s>&quot;OFF&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>RGB Light</p> <p>Should also be used with lights using <a href=../Lights/#white-blend-mode>White Blend Mode</a></p> </div> <p><code>SetOption17 1</code> - enables color status in decimals</p> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>light</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;RGB</span><span class=nv> </span><span class=s>Light&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>state_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>brightness_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Dimmer&quot;</span>
<span class=w>      </span><span class=nt>brightness_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>brightness_scale</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class=w>      </span><span class=nt>on_command_type</span><span class=p>:</span><span class=w> </span><span class=s>&quot;brightness&quot;</span>
<span class=w>      </span><span class=nt>brightness_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Dimmer</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>rgb_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Color2&quot;</span>
<span class=w>      </span><span class=nt>rgb_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>rgb_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>effect_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Scheme&quot;</span>
<span class=w>      </span><span class=nt>effect_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>effect_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Scheme</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>effect_list</span><span class=p>:</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class=w>      </span><span class=nt>payload_on</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ON&quot;</span>
<span class=w>      </span><span class=nt>payload_off</span><span class=p>:</span><span class=w> </span><span class=s>&quot;OFF&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>RGB+W Light</p> <p>In this configuration RGB and white cannot be on at the same time. See <a href=../Lights/#4-channels-rgbw-lights>Lights</a> for options.</p> </div> <p><code>SetOption17 1</code> - enables color status in decimals</p> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>light</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;RGB+W</span><span class=nv> </span><span class=s>Light&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>state_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>brightness_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Dimmer&quot;</span>
<span class=w>      </span><span class=nt>brightness_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>brightness_scale</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class=w>      </span><span class=nt>on_command_type</span><span class=p>:</span><span class=w> </span><span class=s>&quot;brightness&quot;</span>
<span class=w>      </span><span class=nt>brightness_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Dimmer</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>white_value_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>white_value_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/White&quot;</span>
<span class=w>      </span><span class=nt>white_value_scale</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class=w>      </span><span class=nt>white_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.White</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>rgb_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Color2&quot;</span>
<span class=w>      </span><span class=nt>rgb_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>rgb_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>effect_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Scheme&quot;</span>
<span class=w>      </span><span class=nt>effect_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>effect_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{value_json.Scheme}}&quot;</span>
<span class=w>      </span><span class=nt>effect_list</span><span class=p>:</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class=w>      </span><span class=nt>payload_on</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ON&quot;</span>
<span class=w>      </span><span class=nt>payload_off</span><span class=p>:</span><span class=w> </span><span class=s>&quot;OFF&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>RGB+CCT Light</p> <p>Also called RGBWW, RGBCW or 5 channel lights</p> </div> <p><code>SetOption17 1</code> - enables color status in decimals</p> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>light</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;RGBCCT</span><span class=nv> </span><span class=s>Light&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>state_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>brightness_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Dimmer&quot;</span>
<span class=w>      </span><span class=nt>brightness_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>brightness_scale</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class=w>      </span><span class=nt>on_command_type</span><span class=p>:</span><span class=w> </span><span class=s>&quot;brightness&quot;</span>
<span class=w>      </span><span class=nt>brightness_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Dimmer</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>color_temp_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/CT&quot;</span>
<span class=w>      </span><span class=nt>color_temp_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>color_temp_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.CT</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>rgb_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Color2&quot;</span>
<span class=w>      </span><span class=nt>rgb_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>rgb_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>effect_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Scheme&quot;</span>
<span class=w>      </span><span class=nt>effect_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>effect_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Scheme</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>effect_list</span><span class=p>:</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class=w>      </span><span class=nt>payload_on</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ON&quot;</span>
<span class=w>      </span><span class=nt>payload_off</span><span class=p>:</span><span class=w> </span><span class=s>&quot;OFF&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Addressable LED</p> <p>Applies only to <a href=../WS2812B-and-WS2813/ >WS281x</a> lights. </p> </div> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>light</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Addressable</span><span class=nv> </span><span class=s>LED&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/POWER&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>state_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.POWER</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>brightness_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Dimmer&quot;</span>
<span class=w>      </span><span class=nt>brightness_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>brightness_scale</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class=w>      </span><span class=nt>on_command_type</span><span class=p>:</span><span class=w> </span><span class=s>&quot;brightness&quot;</span>
<span class=w>      </span><span class=nt>brightness_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Dimmer</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>rgb_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Color2&quot;</span>
<span class=w>      </span><span class=nt>rgb_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>rgb_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>effect_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/Scheme&quot;</span>
<span class=w>      </span><span class=nt>effect_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/STATE&quot;</span>
<span class=w>      </span><span class=nt>effect_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Scheme</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>effect_list</span><span class=p>:</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">9</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">11</span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
<span class=w>      </span><span class=nt>payload_on</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ON&quot;</span>
<span class=w>      </span><span class=nt>payload_off</span><span class=p>:</span><span class=w> </span><span class=s>&quot;OFF&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>      </span><span class=nt>qos</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class=w>      </span><span class=nt>retain</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>RGB with hex values</p> </div> <p>If you don't want to use <code>SetOption17 1</code> with decimal values and use default hex values, change:</p> <p><div class=highlight><pre><span></span><code><span class=nt>rgb_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)}}&quot;</span>
</code></pre></div> to <div class=highlight><pre><span></span><code><span class=w>  </span><span class=nt>rgb_command_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>&#39;%02X%02X%02X&#39;</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>format(red,</span><span class=nv> </span><span class=s>green,</span><span class=nv> </span><span class=s>blue)}}&quot;</span>
<span class=w>  </span><span class=nt>rgb_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>(value_json.Color[0:2]|int(base=16),value_json.Color[2:4]|int(base=16),value_json.Color[4:6]|int(base=16))</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>join(&#39;,&#39;)}}&quot;</span>
</code></pre></div></p> <div class="admonition example"> <p class=admonition-title>Control RGB and White independently</p> <p>Using color picker will keep white light on. If you use the white slider RGB light will get turned off. White value and dimmer value are connected, to have more granular control you will have to <a href=../Lights/#rgb-and-white-split>split the lights</a>.</p> </div> <p>Replace </p> <p><div class=highlight><pre><span></span><code><span class=nt>rgb_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{value_json.Color.split(&#39;,&#39;)[0:3]|join(&#39;,&#39;)}}&quot;</span>
</code></pre></div> to <div class=highlight><pre><span></span><code><span class=w>  </span><span class=nt>rgb_command_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>&#39;%02X%02X%02X=&#39;</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>format(red,</span><span class=nv> </span><span class=s>green,</span><span class=nv> </span><span class=s>blue)}}&quot;</span>
<span class=w>  </span><span class=nt>rgb_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>(value_json.Color[0:2]|int(base=16),value_json.Color[2:4]|int(base=16),value_json.Color[4:6]|int(base=16))</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>join(&#39;,&#39;)}}&quot;</span>
</code></pre></div></p> <p>The key is the <code>=</code> after color string in hex. It will retain current white value while changing color. </p> <div class="admonition example"> <p class=admonition-title>Using schema: template light</p> <p>Thorough explanation of template: schema lights and its features on <a href=https://blakadder.com/template_schema_lights/ >blakadder.com</a></p> </div> <!-- tabs:end --> <h3 id=sensors>Sensors<a class=headerlink href=#sensors title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/sensor.mqtt/ >MQTT Sensor</a> integration.</p> <p>A sensor will send its data in set intervals defined by <a href=../Commands/#teleperiod><code>TelePeriod</code></a> (default every 5 minutes).</p> <div class="admonition example"> <p class=admonition-title>Temperature sensor</p> </div> <p>Check your sensor name in Tasmota console and change accordingly. This example uses the <a href=../AM2301/ >DHT22</a> sensor.</p> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>sensor</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Temperature&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json[&#39;DHT22&#39;].Temperature</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>unit_of_measurement</span><span class=p>:</span><span class=w> </span><span class=s>&quot;°C&quot;</span><span class=w>  </span><span class=c1># &quot;F&quot; if using Fahrenheit</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">temperature</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Humidity sensor</p> </div> <p>Check your sensor name in Tasmota and change accordingly. This example uses the <a href=../AM2301/ >DHT22</a> sensor.</p> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>sensor</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>ame</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Humidity&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json[&#39;DHT22&#39;].Humidity</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>unit_of_measurement</span><span class=p>:</span><span class=w> </span><span class=s>&quot;%&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">humidity</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Pressure sensor</p> </div> <p>Check your sensor name in Tasmota and change accordingly. This example uses the <a href=../BMP280/ >BMP280</a> sensor.</p> <p><div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>sensor</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Pressure&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.BMP280.Pressure</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>unit_of_measurement</span><span class=p>:</span><span class=w> </span><span class=s>&quot;hPa&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">pressure</span>
</code></pre></div> Change unit_of_measurement to <code>"mmHg"</code> if <a href=../Commands/#setoption24><code>SetOption24 1</code></a></p> <div class="admonition example"> <p class=admonition-title>Wi-Fi Signal Quality</p> </div> <p>Monitor the relative Wi-Fi signal quality of a device. </p> <div class=highlight><pre><span></span><code><span class=nt>sensor</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Wi-Fi</span><span class=nv> </span><span class=s>Quality&quot;</span>
<span class=w>    </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>    </span><span class=nt>unit_of_measurement</span><span class=p>:</span><span class=w> </span><span class=s>&quot;%&quot;</span>
<span class=w>    </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{value_json[&#39;Wifi&#39;].RSSI</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>    </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>    </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>    </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>    </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">signal_strength</span>
<span class=w>    </span><span class=nt>entity_category</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">diagnostic</span><span class=w> </span><span class=c1># moves the entity to the Diagnostic section on the Device Card</span>
</code></pre></div> <h3 id=power-monitoring>Power Monitoring<a class=headerlink href=#power-monitoring title="Permanent link">~</a></h3> <p><img alt="Example of Home Assistant UI" src=../_media/hax_pow1.png style=margin:5px;float:right;width:10em></p> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/sensor.mqtt/ >MQTT Sensor</a> integration.</p> <p>Power monitoring sensors will send their data in set intervals defined by <a href=../Commands/#teleperiod><code>TelePeriod</code></a> (default every 5 minutes).</p> <p>To get all the data in Home Assistant requires multiple sensors which you can later group to your liking in <a href=https://www.home-assistant.io/lovelace/ >Lovelace UI</a></p> <div class="admonition example"> <p class=admonition-title>Power Monitoring</p> </div> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>sensor</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Energy</span><span class=nv> </span><span class=s>Today&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&#39;{{</span><span class=nv> </span><span class=s>value_json[&quot;ENERGY&quot;][&quot;Today&quot;]</span><span class=nv> </span><span class=s>}}&#39;</span>
<span class=w>      </span><span class=nt>unit_of_measurement</span><span class=p>:</span><span class=w> </span><span class=s>&quot;kWh&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">energy</span>
<span class=w>      </span><span class=nt>state_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">measurement</span><span class=w> </span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Power&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&#39;{{</span><span class=nv> </span><span class=s>value_json[&quot;ENERGY&quot;][&quot;Power&quot;]</span><span class=nv> </span><span class=s>}}&#39;</span>
<span class=w>      </span><span class=nt>unit_of_measurement</span><span class=p>:</span><span class=w> </span><span class=s>&quot;W&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">power</span>
<span class=w>      </span><span class=nt>state_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">measurement</span><span class=w> </span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Voltage&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&#39;{{</span><span class=nv> </span><span class=s>value_json[&quot;ENERGY&quot;][&quot;Voltage&quot;]</span><span class=nv> </span><span class=s>}}&#39;</span>
<span class=w>      </span><span class=nt>unit_of_measurement</span><span class=p>:</span><span class=w> </span><span class=s>&quot;V&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">voltage</span>
<span class=w>      </span><span class=nt>state_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">measurement</span><span class=w> </span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Current&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/SENSOR&quot;</span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&#39;{{</span><span class=nv> </span><span class=s>value_json[&quot;ENERGY&quot;][&quot;Current&quot;]</span><span class=nv> </span><span class=s>}}&#39;</span>
<span class=w>      </span><span class=nt>unit_of_measurement</span><span class=p>:</span><span class=w> </span><span class=s>&quot;A&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">current</span>
<span class=w>      </span><span class=nt>state_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">measurement</span><span class=w> </span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>For additional sensors use "Total";"Yesterday";"Period","ApparentPower","ReactivePower";"Factor" in <code>value_template</code> string</p> </div> <p><a href="https://www.youtube.com/watch?v=ktHQrhAF8VQ">Video tutorial</a> on a power monitoring plug setup by Digiblur</p> <h3 id=binary-sensors>Binary Sensors<a class=headerlink href=#binary-sensors title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/binary_sensor.mqtt/ >MQTT Binary Sensor</a> integration.</p> <div class="admonition example"> <p class=admonition-title>PIR Sensor</p> </div> <p>Used for a configured <a href=../PIR-Motion-Sensors/ >PIR Sensor</a> and requires correct <a href=../Commands/#switchmode>SwitchMode</a> with ON/OFF states and this rule:</p> <p><strong>Required Commands</strong> <div class=highlight><pre><span></span><code><span class=go>Rule1 on Switch1#State=1 do Publish stat/%topic%/MOTION ON endon on Switch1#State=0 do Publish stat/%topic%/MOTION OFF endon</span>
<span class=go>Rule1 1</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>binary_sensor</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>unique_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">motion_sensor</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Motion</span><span class=nv> </span><span class=s>Sensor&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/MOTION&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">motion</span>
</code></pre></div></p> <div class="admonition example"> <p class=admonition-title>Door Sensor</p> </div> <p>Requires a reed switch configured in Tasmota. Make sure correct <a href=../Commands/#switchmode>SwitchMode</a> is set</p> <p><strong>Required Commands</strong> <div class=highlight><pre><span></span><code><span class=go>Rule1 on Switch1#State=1 do Publish stat/%topic%/DOOR ON endon on Switch1#State=0 do Publish stat/%topic%/DOOR OFF endon</span>
<span class=go>Rule1 1</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>binary_sensor</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>unique_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">door_sensor</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Door</span><span class=nv> </span><span class=s>Sensor&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/GARAGE&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">door</span><span class=w>   </span><span class=c1># also possible: window, garage_door or opening</span>
</code></pre></div></p> <div class="admonition example"> <p class=admonition-title>RF Bridge</p> </div> <p>An RF door sensor configured with an RF receiver in Tasmota. <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>binary_sensor</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;RF</span><span class=nv> </span><span class=s>bridge</span><span class=nv> </span><span class=s>rfkey&quot;</span>
<span class=w>      </span><span class=nt>payload_on</span><span class=p>:</span><span class=w> </span><span class=s>&quot;1&quot;</span>
<span class=w>      </span><span class=nt>payload_off</span><span class=p>:</span><span class=w> </span><span class=s>&quot;0&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">opening</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/RESULT&quot;</span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&#39;{{</span><span class=nv> </span><span class=s>value_json.RfReceived.RfKey</span><span class=nv> </span><span class=s>}}&#39;</span>
</code></pre></div></p> <!-- tabs:end --> <h3 id=fans>Fans<a class=headerlink href=#fans title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/fan.mqtt/ >MQTT Fan</a> integration.</p> <!-- tabs:start --> <div class="admonition example"> <p class=admonition-title>Fan</p> </div> <p>Derived from <a href=https://github.com/arendst/Tasmota/issues/2839>#2839</a> by @kbickar and @finity69x2</p> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>fan</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>unique_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasmota_fan</span>
<span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Fan&quot;</span>
<span class=w>    </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/FanSpeed&quot;</span>
<span class=w>    </span><span class=nt>speed_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/FanSpeed&quot;</span><span class=w>    </span>
<span class=w>    </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/RESULT&quot;</span>
<span class=w>    </span><span class=nt>speed_state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/RESULT&quot;</span>
<span class=w>    </span><span class=nt>state_value_template</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">&gt;</span>
<span class=w>      </span><span class=no>{% if value_json.FanSpeed is defined %}</span>
<span class=w>        </span><span class=no>{% if value_json.FanSpeed == 0 -%}0{%- elif value_json.FanSpeed &gt; 0 -%}4{%- endif %}</span>
<span class=w>      </span><span class=no>{% else %}</span>
<span class=w>        </span><span class=no>{% if states.fan.tasmota.state == &#39;off&#39; -%}0{%- elif states.fan.tasmota.state == &#39;on&#39; -%}4{%- endif %}</span>
<span class=w>      </span><span class=no>{% endif %}</span>
<span class=w>    </span><span class=nt>speed_value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.FanSpeed</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>    </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tele/tasmota/LWT</span>
<span class=w>    </span><span class=nt>payload_off</span><span class=p>:</span><span class=w> </span><span class=s>&quot;0&quot;</span>
<span class=w>    </span><span class=nt>payload_on</span><span class=p>:</span><span class=w> </span><span class=s>&quot;4&quot;</span>
<span class=w>    </span><span class=nt>payload_low_speed</span><span class=p>:</span><span class=w> </span><span class=s>&quot;1&quot;</span>
<span class=w>    </span><span class=nt>payload_medium_speed</span><span class=p>:</span><span class=w> </span><span class=s>&quot;2&quot;</span>
<span class=w>    </span><span class=nt>payload_high_speed</span><span class=p>:</span><span class=w> </span><span class=s>&quot;3&quot;</span>
<span class=w>    </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>    </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>    </span><span class=nt>speeds</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;off&quot;</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;low&quot;</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;medium&quot;</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;high&quot;</span>
</code></pre></div> <!-- tabs:end --> <h3 id=covers>Covers<a class=headerlink href=#covers title="Permanent link">~</a></h3> <p>Add in Home Assistant using the <a href=https://www.home-assistant.io/components/cover.mqtt/ >MQTT Cover</a> integration.</p> <!-- tabs:start --> <div class="admonition example"> <p class=admonition-title>TuyaMCU Curtain/Shade Motor</p> </div> <p>Requires <code>SetOption66 1</code>. In this example dpId1 is for open/close/stop of the motor, dpId2 sets position and dpId3 displays the current position.</p> <div class=highlight><pre><span></span><code><span class=c1># Example configuration.yaml entry</span>
<span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>cover</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>unique_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tuya_curtain</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tuya</span><span class=nv> </span><span class=s>Curtain&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/TuyaSend4&quot;</span>
<span class=w>      </span><span class=nt>payload_open</span><span class=p>:</span><span class=w> </span><span class=s>&quot;1,0&quot;</span>
<span class=w>      </span><span class=nt>payload_close</span><span class=p>:</span><span class=w> </span><span class=s>&quot;1,2&quot;</span>
<span class=w>      </span><span class=nt>payload_stop</span><span class=p>:</span><span class=w> </span><span class=s>&quot;1,1&quot;</span>
<span class=w>      </span><span class=nt>position_open</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class=w>      </span><span class=nt>position_closed</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class=w>      </span><span class=nt>position_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/RESULT&quot;</span>
<span class=w>      </span><span class=nt>position_template</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">&gt;-</span>
<span class=w>            </span><span class=no>{% if value_json.TuyaReceived.DpType2Id3 is defined %}</span>
<span class=w>            </span><span class=no>{{ value_json.TuyaReceived.DpType2Id3 }}</span>
<span class=w>            </span><span class=no>{% else %}  </span>
<span class=w>            </span><span class=no>{{ state_attr(&#39;cover.tuya_curtain&#39;,&#39;current_position&#39;) | int }}</span>
<span class=w>            </span><span class=no>{% endif %}  </span>
<span class=w>      </span><span class=nt>set_position_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmota/TuyaSend2&quot;</span>
<span class=w>      </span><span class=nt>set_position_template</span><span class=p>:</span><span class=w> </span><span class=s>&#39;2,{{</span><span class=nv> </span><span class=s>position</span><span class=nv> </span><span class=s>}}&#39;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
</code></pre></div> <p>If you change <code>name:</code> make sure to reflect that change in the value_template cover name!</p> <!-- tabs:end --> <h3 id=climate>Climate<a class=headerlink href=#climate title="Permanent link">~</a></h3> <!-- tabs:start --> <p><a href=https://blakadder.com/tuya-climate/ >Detailed guide</a> when using MQTT Climate or Generic Thermostat in Home Assistant</p> <!-- tabs:end --> <h3 id=device-specific>Device Specific<a class=headerlink href=#device-specific title="Permanent link">~</a></h3> <!-- tabs:start --> <!--!! example "iFan02"
OBSOLETE CONFIGURATION! Combination of configs found in issue [#2839](https://github.com/arendst/Tasmota/issues/2839)
and Home Assistant forum thread [Sonoff IFan02 (Tasmota) MQTT Fan](https://community.home-assistant.io/t/sonoff-ifan02-tasmota-mqtt-fan/64083). 

<div class="highlight"><pre><span></span><code><span class="nt">fan</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span><span class="w">  </span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Pat</span><span class="nv"> </span><span class="s">Ceiling</span><span class="nv"> </span><span class="s">Fan&quot;</span><span class="w">  </span>
<span class="w">    </span><span class="nt">state_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stat/ifan02/RESULT&quot;</span>
<span class="w">    </span><span class="nt">speed_state_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stat/ifan02/RESULT&quot;</span>
<span class="w">    </span><span class="nt">state_value_template</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">        </span><span class="no">{% if value_json.FanSpeed is defined %}</span>
<span class="w">          </span><span class="no">{% if value_json.FanSpeed == 0 -%}0{%- elif value_json.FanSpeed &gt; 0 -%}2{%- endif %}</span>
<span class="w">        </span><span class="no">{% else %}</span>
<span class="w">          </span><span class="no">{% if states.fan.pat_ceiling_fan.state == &#39;off&#39; -%}0{%- elif states.fan.pat_ceiling_fan.state == &#39;on&#39; -%}2{%- endif %}</span>
<span class="w">        </span><span class="no">{% endif %}</span>
<span class="w">    </span><span class="nt">speed_value_template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">value_json.FanSpeed</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">availability_topic</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tele/ifan02/LWT</span>
<span class="w">    </span><span class="nt">payload_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Online&quot;</span>
<span class="w">    </span><span class="nt">payload_not_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Offline&quot;</span>
<span class="w">    </span><span class="nt">speed_command_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cmnd/ifan02/FanSpeed&quot;</span>
<span class="w">    </span><span class="nt">payload_low_speed</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">    </span><span class="nt">payload_medium_speed</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2&quot;</span>
<span class="w">    </span><span class="nt">payload_high_speed</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3&quot;</span>
<span class="w">    </span><span class="nt">command_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cmnd/ifan02/FanSpeed&quot;</span>
<span class="w">    </span><span class="nt">payload_off</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0&quot;</span>
<span class="w">    </span><span class="nt">payload_on</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2&quot;</span>
<span class="w">    </span><span class="nt">qos</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">retain</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">speeds</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;low&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;medium&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;high&quot;</span>
<span class="nt">light</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Pat</span><span class="nv"> </span><span class="s">Ceiling</span><span class="nv"> </span><span class="s">Light&quot;</span>
<span class="w">    </span><span class="nt">state_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/ifan02/STATE&quot;</span>
<span class="w">    </span><span class="nt">state_value_template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">value_json.POWER</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">    </span><span class="nt">command_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cmnd/ifan02/POWER&quot;</span>
<span class="w">    </span><span class="nt">availability_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/ifan02/LWT&quot;</span>
<span class="w">    </span><span class="nt">qos</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">payload_on</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ON&quot;</span>
<span class="w">    </span><span class="nt">payload_off</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;OFF&quot;</span>
<span class="w">    </span><span class="nt">payload_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Online&quot;</span>
<span class="w">    </span><span class="nt">payload_not_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Offline&quot;</span>
<span class="w">    </span><span class="nt">retain</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>

!!! example "Sonoff S31"
Configure the device as Sonoff S31, and run: [`SetOption4 1`](Commands.md#setoption4), [`SetOption59 1`](Commands.md#setoption59).

<div class="highlight"><pre><span></span><code><span class="nt">mqtt</span><span class="p">:</span>
<span class="w">  </span><span class="nt">switch</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;s31</span><span class="nv"> </span><span class="s">power&quot;</span>
<span class="w">      </span><span class="nt">state_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/STATE&quot;</span>
<span class="w">      </span><span class="nt">value_template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">value_json.POWER</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">command_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cmnd/s31/POWER&quot;</span>
<span class="w">      </span><span class="nt">availability_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/LWT&quot;</span>
<span class="w">      </span><span class="nt">qos</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">payload_on</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ON&quot;</span>
<span class="w">      </span><span class="nt">payload_off</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;OFF&quot;</span>
<span class="w">      </span><span class="nt">payload_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Online&quot;</span>
<span class="w">      </span><span class="nt">payload_not_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Offline&quot;</span>
<span class="w">      </span><span class="nt">retain</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>

<span class="nt">mqtt</span><span class="p">:</span>
<span class="w">  </span><span class="nt">sensor</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;s31</span><span class="nv"> </span><span class="s">Voltage&quot;</span>
<span class="w">      </span><span class="nt">state_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/SENSOR&quot;</span>
<span class="w">      </span><span class="nt">value_template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">value_json[&#39;ENERGY&#39;].Voltage</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">unit_of_measurement</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;V&quot;</span>
<span class="w">      </span><span class="nt">availability_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/LWT&quot;</span>
<span class="w">      </span><span class="nt">qos</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">payload_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Online&quot;</span>
<span class="w">      </span><span class="nt">payload_not_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Offline&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;s31</span><span class="nv"> </span><span class="s">Current&quot;</span>
<span class="w">      </span><span class="nt">state_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/SENSOR&quot;</span>
<span class="w">      </span><span class="nt">value_template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">value_json[&#39;ENERGY&#39;].Current</span><span class="nv"> </span><span class="s">|</span><span class="nv"> </span><span class="s">round(2)</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">unit_of_measurement</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A&quot;</span>
<span class="w">      </span><span class="nt">availability_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/LWT&quot;</span>
<span class="w">      </span><span class="nt">qos</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">payload_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Online&quot;</span>
<span class="w">      </span><span class="nt">payload_not_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Offline&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;s31</span><span class="nv"> </span><span class="s">Power&quot;</span>
<span class="w">      </span><span class="nt">state_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/SENSOR&quot;</span>
<span class="w">      </span><span class="nt">value_template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">value_json[&#39;ENERGY&#39;].Power</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">unit_of_measurement</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;W&quot;</span>
<span class="w">      </span><span class="nt">availability_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/LWT&quot;</span>
<span class="w">      </span><span class="nt">qos</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">payload_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Online&quot;</span>
<span class="w">      </span><span class="nt">payload_not_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Offline&quot;</span>
<span class="w">      </span><span class="nt">device_class</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">power</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;s31</span><span class="nv"> </span><span class="s">Power</span><span class="nv"> </span><span class="s">Factor&quot;</span>
<span class="w">      </span><span class="nt">state_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/SENSOR&quot;</span>
<span class="w">      </span><span class="nt">value_template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">value_json[&#39;ENERGY&#39;].Factor</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">availability_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/LWT&quot;</span>
<span class="w">      </span><span class="nt">qos</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">payload_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Online&quot;</span>
<span class="w">      </span><span class="nt">payload_not_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Offline&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;s31</span><span class="nv"> </span><span class="s">Energy</span><span class="nv"> </span><span class="s">Today&quot;</span>
<span class="w">      </span><span class="nt">state_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/SENSOR&quot;</span>
<span class="w">      </span><span class="nt">value_template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">value_json[&#39;ENERGY&#39;].Today</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">unit_of_measurement</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kWh&quot;</span>
<span class="w">      </span><span class="nt">availability_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/LWT&quot;</span>
<span class="w">      </span><span class="nt">qos</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">payload_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Online&quot;</span>
<span class="w">      </span><span class="nt">payload_not_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Offline&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;s31</span><span class="nv"> </span><span class="s">Energy</span><span class="nv"> </span><span class="s">Yesterday&quot;</span>
<span class="w">      </span><span class="nt">state_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/SENSOR&quot;</span>
<span class="w">      </span><span class="nt">value_template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">value_json[&#39;ENERGY&#39;].Yesterday</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">unit_of_measurement</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kWh&quot;</span>
<span class="w">      </span><span class="nt">availability_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/LWT&quot;</span>
<span class="w">      </span><span class="nt">qos</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">payload_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Online&quot;</span>
<span class="w">      </span><span class="nt">payload_not_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Offline&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;s31</span><span class="nv"> </span><span class="s">Energy</span><span class="nv"> </span><span class="s">Total&quot;</span>
<span class="w">      </span><span class="nt">state_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/SENSOR&quot;</span>
<span class="w">      </span><span class="nt">value_template</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;{{</span><span class="nv"> </span><span class="s">value_json[&#39;ENERGY&#39;].Total</span><span class="nv"> </span><span class="s">}}&quot;</span>
<span class="w">      </span><span class="nt">unit_of_measurement</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kWh&quot;</span>
<span class="w">      </span><span class="nt">availability_topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tele/s31/LWT&quot;</span>
<span class="w">      </span><span class="nt">qos</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">payload_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Online&quot;</span>
<span class="w">      </span><span class="nt">payload_not_available</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Offline&quot;</span>
</code></pre></div>
--> <!-- tabs:end --> <!-- tabs:start --> <div class="admonition example"> <p class=admonition-title>Covers</p> </div> <p>For shutter position to persist in Home Assistant through device reboots, execute <code>PowerRetain 1</code>.</p> <p>These sample configurations should allow the shutter work in Home Assistant. This is only an example and may need further modification to work in your environment.</p> <p>This example uses a new configuration for roller shutters with options for positioning. It assumes that <code>%prefix%/%topic%/</code> is configured in the Tasmota Full Topic MQTT parameter. </p> <p><div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>cover</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Balcony</span><span class=nv> </span><span class=s>Blinds&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/%topic%/LWT&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>      </span><span class=nt>position_topic</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">stat/%topic%/Shutter1</span>
<span class=w>      </span><span class=nt>position_open</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class=w>      </span><span class=nt>position_closed</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class=w>      </span><span class=nt>set_position_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/%topic%/ShutterPosition1&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/%topic%/Backlog&quot;</span>
<span class=w>      </span><span class=nt>payload_open</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ShutterOpen1&quot;</span>
<span class=w>      </span><span class=nt>payload_close</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ShutterClose1&quot;</span>
<span class=w>      </span><span class=nt>payload_stop</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ShutterStop1&quot;</span>
<span class=w>      </span><span class=nt>retain</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class=w>      </span><span class=nt>optimistic</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class=w>      </span><span class=nt>qos</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</code></pre></div> Check <a href=https://github.com/stefanbode/Sonoff-Tasmota/issues/130>Issue 130</a> for more information about this configuration.</p> <p>Another integration example:<br> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>cover</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Test&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/%topic%/LWT&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/%topic%/RESULT&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/%topic%/Backlog&quot;</span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&#39;{{</span><span class=nv> </span><span class=s>value</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>int</span><span class=nv> </span><span class=s>}}&#39;</span>
<span class=w>      </span><span class=nt>qos</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class=w>      </span><span class=nt>retain</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class=w>      </span><span class=nt>payload_open</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ShutterOpen1&quot;</span>
<span class=w>      </span><span class=nt>payload_close</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ShutterClose1&quot;</span>
<span class=w>      </span><span class=nt>payload_stop</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ShutterStop1&quot;</span>
<span class=w>      </span><span class=nt>state_open</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ON&quot;</span>
<span class=w>      </span><span class=nt>state_closed</span><span class=p>:</span><span class=w> </span><span class=s>&quot;OFF&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>      </span><span class=nt>optimistic</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class=w>      </span><span class=nt>tilt_command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&#39;cmnd/%topic%/ShutterPosition1&#39;</span>
<span class=w>      </span><span class=nt>tilt_status_topic</span><span class=p>:</span><span class=w> </span><span class=s>&#39;cmnd/%topic%/ShutterPosition1&#39;</span>
<span class=w>      </span><span class=nt>set_position_topic</span><span class=p>:</span><span class=w> </span><span class=s>&#39;cmnd/%topic%/ShutterPosition1&#39;</span>
<span class=w>      </span><span class=nt>position_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/%topic%/SHUTTER1&quot;</span>
<span class=w>      </span><span class=nt>tilt_min</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class=w>      </span><span class=nt>tilt_max</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class=w>      </span><span class=nt>tilt_closed_value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class=w>      </span><span class=nt>tilt_opened_value</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
</code></pre></div> Integration example with position updated during movement (Tasmota versions &gt;= v8.1.0.5): </p> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>cover</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Balcony</span><span class=nv> </span><span class=s>Blinds&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/%topic%/LWT&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>      </span><span class=nt>position_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/%topic%/RESULT&quot;</span>
<span class=w>      </span><span class=nt>position_template</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">&gt;</span>
<span class=w>        </span><span class=no>{% if (&#39;Shutter1&#39; in value_json) and (&#39;Position&#39; in value_json.Shutter1) %}</span>
<span class=w>          </span><span class=no>{{ value_json.Shutter1.Position }}</span>
<span class=w>        </span><span class=no>{% else %}</span>
<span class=w>          </span><span class=no>{% if is_state(&#39;cover.balcony_blinds&#39;, &#39;unknown&#39;) %}</span>
<span class=w>            </span><span class=no>50</span>
<span class=w>          </span><span class=no>{% else %}</span>
<span class=w>            </span><span class=no>{{ state_attr(&#39;cover.balcony_blinds&#39;,&#39;current_position&#39;) }}</span>
<span class=w>          </span><span class=no>{% endif %}</span>
<span class=w>        </span><span class=no>{% endif %}    </span>
<span class=w>      </span><span class=nt>position_open</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class=w>      </span><span class=nt>position_closed</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class=w>      </span><span class=nt>set_position_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/%topic%/ShutterPosition1&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/%topic%/Backlog&quot;</span>
<span class=w>      </span><span class=nt>payload_open</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ShutterOpen1&quot;</span>
<span class=w>      </span><span class=nt>payload_close</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ShutterClose1&quot;</span>
<span class=w>      </span><span class=nt>payload_stop</span><span class=p>:</span><span class=w> </span><span class=s>&quot;ShutterStop1&quot;</span>
</code></pre></div> <p>In addition, add to your home assistant start up automation a query for the current shutter position: <div class=highlight><pre><span></span><code><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>alias</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Power</span><span class=nv> </span><span class=s>state</span><span class=nv> </span><span class=s>on</span><span class=nv> </span><span class=s>HA</span><span class=nv> </span><span class=s>start-up&quot;</span>
<span class=w>  </span><span class=nt>trigger</span><span class=p>:</span>
<span class=w>    </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">homeassistant</span>
<span class=w>    </span><span class=nt>event</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">start</span>
<span class=w>  </span><span class=nt>action</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>service</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
<span class=w>      </span><span class=nt>data</span><span class=p>:</span>
<span class=w>        </span><span class=nt>topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/%shutters</span><span class=nv> </span><span class=s>grouptopic%/shutterposition&quot;</span>
<span class=w>        </span><span class=nt>payload</span><span class=p>:</span><span class=w> </span><span class=s>&quot;&quot;</span><span class=w>       </span>
</code></pre></div></p> <h3 id=zigbee-devices>Zigbee Devices<a class=headerlink href=#zigbee-devices title="Permanent link">~</a></h3> <!-- tabs:start --> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>The following Zigbee examples assume <a href=../Commands/#setoption83><code>SetOption83</code></a>, <a href=../Commands/#setoption89><code>SetOption89</code></a>, <a href=../Commands/#setoption100><code>SetOption100</code></a>, <a href=../Commands/#setoption112><code>SetOption112</code></a>, <a href=../Commands/#setoption118><code>SetOption118</code></a>, <a href=../Commands/#setoption119><code>SetOption119</code></a> are all set to <code>0</code>. Setting any of these to <code>1</code> will change topic and/or payload structure from that used in the examples.</p> </div> <div class="admonition example"> <p class=admonition-title>Dimmable Light</p> </div> <p>This configuration is for a dimmable light reporting on <code>0xE1F9</code> using endpoint 1, cluster 8 for brightness. <code>ZbRead</code> part in the template is needed to always update the brightness values.</p> <div class=highlight><pre><span></span><code><span class=c1># Example configuration.yaml entry</span>
<span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>light</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>schema</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">template</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Fire</span><span class=nv> </span><span class=s>Light&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/zigbee-gateway/Backlog&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/zigbee-gateway/SENSOR&quot;</span>
<span class=w>      </span><span class=nt>command_on_template</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">&gt;</span>
<span class=w>          </span><span class=no>{%- if brightness is defined -%}</span>
<span class=w>          </span><span class=no>ZbSend { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;send&quot;:{&quot;Dimmer&quot;:{{ brightness }} } }; ZbSend { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;send&quot;:{&quot;Power&quot;:true} }; delay 20; ZbRead { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;endpoint&quot;:1, &quot;cluster&quot;:8, &quot;read&quot;:0 }</span>
<span class=w>          </span><span class=no>{%- else -%}</span>
<span class=w>          </span><span class=no>ZbSend { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;send&quot;:{&quot;Power&quot;:true} }; delay 20; ZbRead { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;endpoint&quot;:1, &quot;cluster&quot;:8, &quot;read&quot;:0 }</span>
<span class=w>          </span><span class=no>{%- endif -%}</span>
<span class=w>      </span><span class=nt>command_off_template</span><span class=p>:</span><span class=w> </span><span class=s>&#39;ZbSend</span><span class=nv> </span><span class=s>{</span><span class=nv> </span><span class=s>&quot;device&quot;:&quot;0xE1F9&quot;,</span><span class=nv> </span><span class=s>&quot;send&quot;:{&quot;Power&quot;:false}</span><span class=nv> </span><span class=s>};</span><span class=nv> </span><span class=s>delay</span><span class=nv> </span><span class=s>20;</span><span class=nv> </span><span class=s>ZbRead</span><span class=nv> </span><span class=s>{</span><span class=nv> </span><span class=s>&quot;device&quot;:&quot;0xE1F9&quot;,</span><span class=nv> </span><span class=s>&quot;endpoint&quot;:1,</span><span class=nv> </span><span class=s>&quot;cluster&quot;:8,</span><span class=nv> </span><span class=s>&quot;read&quot;:0</span><span class=nv> </span><span class=s>}&#39;</span>
<span class=w>      </span><span class=nt>state_template</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">&gt;</span>
<span class=w>          </span><span class=no>{% if value_json.ZbReceived is defined and value_json.ZbReceived[&#39;0xE1F9&#39;] is defined and value_json.ZbReceived[&#39;0xE1F9&#39;].Power is defined %}</span>
<span class=w>          </span><span class=no>{% if value_json.ZbReceived[&#39;0xE1F9&#39;].Power == true %}</span>
<span class=w>          </span><span class=no>on</span>
<span class=w>          </span><span class=no>{% else %}</span>
<span class=w>          </span><span class=no>off</span>
<span class=w>          </span><span class=no>{% endif %}</span>
<span class=w>          </span><span class=no>{% else %}</span>
<span class=w>          </span><span class=no>{{ states(&#39;light.fire_light&#39;) }}</span>
<span class=w>          </span><span class=no>{% endif %}</span>
<span class=w>      </span><span class=nt>brightness_template</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">&gt;</span>
<span class=w>          </span><span class=no>{%- if value_json.ZbReceived is defined and value_json.ZbReceived[&#39;0xE1F9&#39;] is defined and value_json.ZbReceived[&#39;0xE1F9&#39;].Dimmer is defined -%}</span>
<span class=w>          </span><span class=no>{{ value_json[&#39;ZbReceived&#39;][&#39;0xE1F9&#39;].Dimmer | int }}</span>
<span class=w>          </span><span class=no>{%- else -%}</span>
<span class=w>          </span><span class=no>{{ state_attr(&#39;light.fire_light&#39;, &#39;brightness&#39;) | int }}</span>
<span class=w>          </span><span class=no>{%- endif -%}</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Water Leak Sensor</p> </div> <p>This specific configuration is for Xiaomi Aqara Water Leak sensor reporting on <code>0x099F</code>.</p> <div class=highlight><pre><span></span><code><span class=c1># Example configuration.yaml entry</span>
<span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>binary_sensor</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Water</span><span class=nv> </span><span class=s>Leak&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/zigbee-gateway/SENSOR&quot;</span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">&gt;</span>
<span class=w>        </span><span class=no>{%- if value_json.ZbReceived is defined and value_json.ZbReceived[&#39;0x099F&#39;] is defined -%}</span>
<span class=w>        </span><span class=no>{%- if value_json.ZbReceived[&#39;0x099F&#39;][&#39;0500!00&#39;] == &#39;010000FF0000&#39; -%}</span>
<span class=w>        </span><span class=no>ON</span>
<span class=w>        </span><span class=no>{% else %}</span>
<span class=w>        </span><span class=no>OFF</span>
<span class=w>        </span><span class=no>{% endif %}</span>
<span class=w>        </span><span class=no>{% else %}</span>
<span class=w>        </span><span class=no>{{ states(&#39;binary_sensor.water_leak&#39;) }}</span>
<span class=w>        </span><span class=no>{% endif %}</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/zigbee-gateway/LWT&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">moisture</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Enable join button</p> </div> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>button</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>unique_id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">z2t_enable_join</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Zigbee2Tasmota</span><span class=nv> </span><span class=s>enable</span><span class=nv> </span><span class=s>join&quot;</span>
<span class=w>      </span><span class=nt>command_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/zigbee-gateway/ZbPermitJoin&quot;</span><span class=w> </span>
<span class=w>      </span><span class=nt>payload_press</span><span class=p>:</span><span class=w> </span><span class=s>&quot;1&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/zigbee-gateway/LWT&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
<span class=w>      </span><span class=nt>entity_category</span><span class=p>:</span><span class=w> </span><span class=s>&quot;default&quot;</span>
<span class=w>      </span><span class=nt>device_class</span><span class=p>:</span><span class=w> </span><span class=s>&quot;restart&quot;</span>
</code></pre></div> <!-- tabs:end --> <h2 id=useful-automations>Useful Automations<a class=headerlink href=#useful-automations title="Permanent link">~</a></h2> <div class="admonition example"> <p class=admonition-title>Extended device information</p> </div> <p>Wi-Fi signal quality can be added as a parameter to any previous configuration by appending this section to the existing configuration yaml</p> <div class=highlight><pre><span></span><code><span class=w>    </span><span class=nt>json_attributes_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/STATE&quot;</span>
<span class=w>    </span><span class=nt>json_attributes_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{</span><span class=nv> </span><span class=s>value_json.Wifi</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>tojson</span><span class=nv> </span><span class=s>}}&quot;</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Sync Power State</p> </div> <p>When MQTT broker or Home Assistant is restarted, or there is a WiFi outage, Tasmota device states may not be synced with Home Assistant. Use this automation to keep your devices in sync, including power state, <em>immediately</em> after Home Assistant is started.</p> <div class=highlight><pre><span></span><code><span class=nt>automation</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>id</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Sync Tasmota states</span>
<span class=w>    </span><span class=nt>alias</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Sync Tasmota states</span>
<span class=w>    </span><span class=nt>initial_state</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class=w>    </span><span class=nt>trigger</span><span class=p>:</span>
<span class=w>      </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">homeassistant</span>
<span class=w>      </span><span class=nt>event</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">start</span>
<span class=w>    </span><span class=nt>action</span><span class=p>:</span>
<span class=w>    </span><span class=c1># sync state for devices with default fulltopics</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>service</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
<span class=w>      </span><span class=nt>data</span><span class=p>:</span>
<span class=w>        </span><span class=nt>topic</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cmnd/tasmotas/state</span>
<span class=w>        </span><span class=nt>payload</span><span class=p>:</span><span class=w> </span><span class=s>&#39;&#39;</span>
<span class=w>    </span><span class=c1># sync state for pre8.2 autodiscovery devices</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>service</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
<span class=w>      </span><span class=nt>data</span><span class=p>:</span>
<span class=w>        </span><span class=nt>topic</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">tasmotas/cmnd/state</span>
<span class=w>        </span><span class=nt>payload</span><span class=p>:</span><span class=w> </span><span class=s>&#39;&#39;</span>
</code></pre></div> <p>To sync a single TuyaMCU device states add this block with your %topic% to the automation. !!! bug You could use <code>tasmotas</code> but SerialSend might cause issues on other devices so proceed with caution.</p> <div class=highlight><pre><span></span><code><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>service</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
<span class=w>      </span><span class=nt>data</span><span class=p>:</span>
<span class=w>        </span><span class=nt>topic</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cmnd/%topic%/serialsend5</span>
<span class=w>        </span><span class=nt>payload</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">55aa0001000000</span>
</code></pre></div> <p>Sync Zigbee device states. Add this block with your %topic% and your Zigbee device name, endpoint and cluster.</p> <div class="admonition example"> <p class=admonition-title>Example for a dimmable light</p> </div> <div class=highlight><pre><span></span><code><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>service</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
<span class=w>      </span><span class=nt>data</span><span class=p>:</span>
<span class=w>        </span><span class=nt>topic</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cmnd/zigbee-gateway/Backlog</span>
<span class=w>        </span><span class=nt>payload</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ZbRead { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;endpoint&quot;:1, &quot;cluster&quot;:6, &quot;read&quot;:0 }; delay 5; ZbRead { &quot;device&quot;:&quot;0xE1F9&quot;, &quot;endpoint&quot;:1, &quot;cluster&quot;:8, &quot;read&quot;:0 }</span>
</code></pre></div> <div class="admonition example"> <p class=admonition-title>Report Firmware Version</p> </div> <p>Add a sensor like below for each Tasmota device whose firmware version you want to track.</p> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>sensor</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mqtt</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota&quot;</span>
<span class=w>      </span><span class=nt>state_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;stat/tasmota/STATUS2&quot;</span>
<span class=w>      </span><span class=nt>value_template</span><span class=p>:</span><span class=w> </span><span class=s>&quot;{{value_json[&#39;StatusFWR&#39;].Version</span><span class=nv> </span><span class=s>}}&quot;</span>
<span class=w>      </span><span class=nt>availability_topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;tele/tasmota/LWT&quot;</span>
<span class=w>      </span><span class=nt>payload_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Online&quot;</span>
<span class=w>      </span><span class=nt>payload_not_available</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Offline&quot;</span>
</code></pre></div> <p>Automation to have each device report firmware version on Home Assistant reboot. <em>You can manually trigger this automation from Home Assistant UI.</em></p> <div class=highlight><pre><span></span><code><span class=nt>automation</span><span class=p>:</span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>alias</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>Firmware</span><span class=nv> </span><span class=s>Version</span><span class=nv> </span><span class=s>Check&quot;</span>
<span class=w>    </span><span class=nt>trigger</span><span class=p>:</span>
<span class=w>      </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">homeassistant</span>
<span class=w>      </span><span class=nt>event</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">start</span>
<span class=w>    </span><span class=nt>action</span><span class=p>:</span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>service</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">mqtt.publish</span>
<span class=w>        </span><span class=nt>data</span><span class=p>:</span>
<span class=w>          </span><span class=nt>topic</span><span class=p>:</span><span class=w> </span><span class=s>&quot;cmnd/tasmotas/STATUS&quot;</span>
<span class=w>          </span><span class=nt>payload</span><span class=p>:</span><span class=w> </span><span class=s>&quot;2&quot;</span>
</code></pre></div> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>If you want all your devices to switch to autodiscovery method go through Developer tools - MQTT by publishing to grouptopic <code>cmnd/tasmotas/SetOption19</code> with payload <code>1</code></p> </div> <div class="admonition example"> <p class=admonition-title>Get most recent Tasmota firmware version number from github</p> </div> <div class=highlight><pre><span></span><code><span class=nt>mqtt</span><span class=p>:</span>
<span class=w>  </span><span class=nt>sensor</span><span class=p>:</span>
<span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>platform</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">command_line</span>
<span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;Tasmota</span><span class=nv> </span><span class=s>(latest</span><span class=nv> </span><span class=s>version)&quot;</span>
<span class=w>      </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s>&#39;curl</span><span class=nv> </span><span class=s>-s</span><span class=nv> </span><span class=s>https://api.github.com/repos/arendst/Tasmota/tags</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>grep</span><span class=nv> </span><span class=s>&quot;name&quot;</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>sort</span><span class=nv> </span><span class=s>--version-sort</span><span class=nv> </span><span class=s>-r</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>head</span><span class=nv> </span><span class=s>-n</span><span class=nv> </span><span class=s>1</span><span class=nv> </span><span class=s>|</span><span class=nv> </span><span class=s>sed</span><span class=nv> </span><span class=s>-E</span><span class=nv> </span><span class=s>&quot;s/\s*\&quot;name\&quot;:</span><span class=nv> </span><span class=s>\&quot;(.*)\&quot;,*/\1/g&quot;&#39;</span>
<span class=w>      </span><span class=nt>scan_interval</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">86400</span><span class=w> </span><span class=c1># check once every day</span>
</code></pre></div> <p><img alt src=https://cdn.pbrd.co/images/HY47i1b.jpg></p> <h2 id=mqtt-discovery-removed>MQTT Discovery <strong>REMOVED</strong><a class=headerlink href=#mqtt-discovery-removed title="Permanent link">~</a></h2> <div class="admonition failure"> <p class=admonition-title>Home Assistant MQTT Discovery is removed from all builds of Tasmota and development of this feature is halted!</p> </div> <p>Home Assistant has a feature called <a href=https://www.home-assistant.io/integrations/mqtt/#mqtt-discovery>MQTT discovery</a>. With MQTT discovery no user interaction or configuration file editing is needed to add new devices in Home Assistant. Most of the changes will be updated in HA automatically.</p> <h4 id=enable-autodiscovery>Enable Autodiscovery<a class=headerlink href=#enable-autodiscovery title="Permanent link">~</a></h4> <p>Enable autodiscovery on a device with the command:</p> <div class=highlight><pre><span></span><code><span class=go>SetOption19 1</span>
</code></pre></div> <p>After the automatic discovery feature is enabled a retained MQTT message starting with topic "homeassistant/" is sent to the broker. That message contains your device configuration which will be picked up and used by Home Assistant to automatically add your device to MQTT integrations. </p> <p>Tasmota uses <a href=../Commands/#devicename><code>DeviceName</code></a> to identify the device in Home Assistant MQTT integration and <a href=../Commands/#friendlyname><code>FriendlyName&lt;x&gt;</code></a> to identify power outputs (switch or light entities in HA).</p> <div class="admonition note"> <p class=admonition-title>When changing some settings you might need a reboot or use <code>SetOption19 1</code> again to see the new changes under Home Assistant.</p> </div> <div class="admonition note"> <p class=admonition-title>Special settings for each device type:</p> </div> <h4 id=finalising-setup>Finalising Setup<a class=headerlink href=#finalising-setup title="Permanent link">~</a></h4> <p>All automatically discovered entities will show up under <strong>Configuration -&gt; Integrations -&gt; MQTT</strong> card.</p> <p>The entities are grouped under a device defined by DeviceName and identified by Tasmota as the "manufacturer": <img alt=Integration src=../_media/hass_integrations_screen.jpg></p> <p>Overview of a Tasmota device in Home Assistant integration compared to <strong>Configuration -&gt; Configure Other</strong>:</p> <p><img alt="Device layout" src=../_media/hass_1.jpg><img alt="Device layout" src=../_media/hass_0.jpg></p> <p>For every device an informative sensor will be created automatically:</p> <p><img alt="Informative sensor" src=../_media/hass_information_sensor.jpg></p> <div class="admonition warning"> <p class=admonition-title>This sensor will update on <code>TelePeriod</code> which is 5 minutes by default</p> <p>It will show as "Unavailable" until the first TelePeriod MQTT message</p> </div> <p>You can further customise your device in Home Assistant by clicking on the entity name.</p> <div class="admonition note"> <p class=admonition-title>Enabling discovery will automatically change some SetOptions to suit the new configuration</p> </div> <p><strong><code>SetOption4</code> to <code>0</code></strong>: Return MQTT response always as <code>RESULT</code> and not as %COMMAND% topic</p> <p><strong><code>SetOption17</code> to <code>1</code></strong>: Show Color as a comma-separated decimal string instead of hexadecimal</p> <p><strong><code>SetOption59</code> to <code>1</code></strong>: Send <code>tele/%topic%/STATE</code> in addition to <code>stat/%topic%/RESULT</code> for commands <code>State</code>, <code>Power</code> and any command causing a light to be turned on.</p> <h4 id=supported-entities_1>Supported Entities<a class=headerlink href=#supported-entities_1 title="Permanent link">~</a></h4> <div class="tabbed-set tabbed-alternate" data-tabs=1:5><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><input id=__tabbed_1_3 name=__tabbed_1 type=radio><input id=__tabbed_1_4 name=__tabbed_1 type=radio><input id=__tabbed_1_5 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>Buttons</label><label for=__tabbed_1_2>Lights</label><label for=__tabbed_1_3>Relays</label><label for=__tabbed_1_4>Sensors</label><label for=__tabbed_1_5>Switches</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>Announced to Home Assistant as <a href=https://www.home-assistant.io/docs/automation/trigger/ >Automation Trigger</a>.</p> <p>To have buttons discovered <a href=../Commands/#setoption73><code>SetOption73</code></a> must be set to <code>1</code> and it will automatically start to listen and publish using <code>/stat/%topic%/BUTTON&lt;x&gt;T</code> topic.</p> <p>Discovery will follow all the possible combinations made using SetOption1, SetOption11 and Setoption13.</p> </div> <div class=tabbed-block> <p>Announced to Home Assistant as <a href=https://www.home-assistant.io/integrations/light.mqtt/ >MQTT Light</a>.</p> <p>Discovery supports single channel Dimmer as well as multi-channel RGB, RGBW, RGBCCT and CCT lights.</p> <p>To have multi-channel PWM instead of a single light entity under Home Assistant use <a href=../Commands/#setoption68><code>SetOption68 1</code></a>.</p> <p>If you have a light with 4 or 5 channels (RGB+W or RGB+CCT) you can <a href=../Lights/#rgb-and-white-split>split them</a> into two separate lights, first one for RGB and second for White/CT. </p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Tasmota will no longer switch <code>%prefix%</code> and <code>%topic%</code> and will keep the default topic structure. This could lead to a very long topic for a light and autodiscovery could fail to parse the necessary code for Home Assistant. In this case a warning will be shown in the logs and Tasmota Console. To avoid this issue keep your <a href=../Commands/#topic>Topic</a> and/or <a href=../Commands/#friendlyname>FriendlyName</a> as short as possible.</p> </div> <p><em>Alternatively you can configure it manually using <a href=https://www.home-assistant.io/integrations/light/ >Light</a> integration.</em></p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Pay attention to the order of the relays when used in conjunction with lights. The relays have priority over the lights, an incorrect order could lead to an erroneous light control. Add them starting from relay1. Entities for relays and lights will not be available in Home Assistant until the configuration will be updated.</p> </div> </div> <div class=tabbed-block> <p>Announced to Home Assistant as <a href=https://www.home-assistant.io/integrations/switch.mqtt/ >MQTT Switch</a>.</p> <p>To make a relay discovered as "light" in Home Assistant use command <a href=../Commands/#setoption30><code>SetOption30 1</code></a> </p> <p><em>Alternatively you can configure it manually using <a href=https://www.home-assistant.io/components/light.switch/ >Light Switch</a> integration.</em></p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Pay attention to the order of the relays when used in conjunction with lights. The relays have priority over the lights, an incorrect order could lead to an erroneous light control. Add them starting from relay1. Entities for relays and lights will not be available in Home Assistant until the configuration will be updated.</p> </div> </div> <div class=tabbed-block> <p>Announced to Home Assistant as <a href=https://www.home-assistant.io/integrations/sensor.mqtt/ >MQTT Sensor</a>.</p> <p>When discovery is enabled Tasmota will send all the sensors information to Home Assistant. For each sensor present, entities will be created in numbers equal to the items present below him.</p> <p>Example: <br> An AM2301 sensor will generate one entity for Temperature, one for Humidity and one for Dew point. </p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Please be advised that not all sensors can be correctly rendered under Home Assistant. In those cases a fallback function will be used to create a generic sensor and the correct operation is not guaranteed.</p> </div> </div> <div class=tabbed-block> <p>Announced to Home Assistant as <a href=https://www.home-assistant.io/integrations/binary_sensor.mqtt/ >MQTT Binary Sensor</a> and/or as an <a href=https://www.home-assistant.io/docs/automation/trigger/ >Automation Trigger</a>.</p> <p>To have switches discovered <code>SwitchTopic</code> must be set to a custom name and it will automatically start to listen and publish using <code>stat/%topic%/SWITCH&lt;x&gt;</code> (binary sensor) or <code>stat/%topic%/SWITCH&lt;x&gt;T</code> (trigger) topics.</p> <p>Depending by the <code>SwitchMode</code>used, a switch can be a Trigger (<code>TOGGLE</code>or <code>HOLD</code>), a Binary Sensor (<code>ON</code>/<code>OFF</code>) or both at the same time.</p> <p>Example:<br> When using with <code>SwitchMode 0</code> Tasmota will create just one Trigger for <code>TOGGLE</code>.<br> When using with <code>SwitchMode 1</code> Tasmota will create a <code>Binary Sensor</code> with <code>ON</code> and <code>OFF</code> Payloads.<br> When using with <code>Switchmode 5</code> Tasmota will create a <code>Binary Sensor</code> with <code>ON</code> and <code>OFF</code> Payloads and a Trigger for <code>TOGGLE</code>. </p> <p>All switchmodes are supported with the sole exception of <code>SwitchMode11</code> and <code>SwitchMode12</code> able to generate just a <code>TOGGLE</code> trigger.</p> <p><strong>When a switch is set to a different topic than <code>0</code> is not possible to use <code>Switch#State</code> as a trigger for rules.</strong></p> </div> </div> </div> <p>Types of devices not listed above (covers, etc) require <a href=#editing-configurationyaml>manual configuration</a></p> <h2 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">~</a></h2> <p>Test if Tasmota and Home Assistant can communicate properly. </p> <p><a href=https://my.home-assistant.io/redirect/config_mqtt/ ><img alt="Open your Home Assistant instance and show your MQTT configuration panel." src=https://my.home-assistant.io/badges/config_mqtt.svg></a></p> <p>Click on the above button or in your Home Assistant web UI go to <strong>Configuration - Integrations</strong>, locate MQTT card and click on <strong>CONFIGURE</strong>. Subscribe to <code>tele/%topic%/STATE</code> and click <strong>START LISTENING</strong>. You should see a JSON response from your device inside 5 minutes.</p> <p>To test control of a relay or light, as <strong>Publish a packet topic</strong> enter <code>cmnd/%topic%/POWER</code> with payload <code>toggle</code> or <code>2</code>. When you click <strong>PUBLISH</strong> your device should switch state and a JSON resc <img alt src=../_media/hass1.png> <img alt src=../_media/hass2.png></p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://discord.gg/Ks2Kzd4 target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg> </a> <a href=https://t.me/tasmota target=_blank rel=noopener title=t.me class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M256 8a248 248 0 1 0 0 496 248 248 0 1 0 0-496m115 168.7c-3.7 39.2-19.9 134.4-28.1 178.3-3.5 18.6-10.3 24.8-16.9 25.4-14.4 1.3-25.3-9.5-39.3-18.7-21.8-14.3-34.2-23.2-55.3-37.2-24.5-16.1-8.6-25 5.3-39.5 3.7-3.8 67.1-61.5 68.3-66.7.2-.7.3-3.1-1.2-4.4s-3.6-.8-5.1-.5c-2.2.5-37.1 23.5-104.6 69.1-9.9 6.8-18.9 10.1-26.9 9.9-8.9-.2-25.9-5-38.6-9.1-15.5-5-27.9-7.7-26.8-16.3.6-4.5 6.7-9 18.4-13.7 72.3-31.5 120.5-52.3 144.6-62.3 68.9-28.6 83.2-33.6 92.5-33.8 2.1 0 6.6.5 9.6 2.9 2 1.7 3.2 4.1 3.5 6.7.5 3.2.6 6.5.4 9.8z"/></svg> </a> <a href=https://github.com/tasmota target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "content.action.edit", "content.code.copy"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../extra_javascript/tablesort.js></script> </body> </html>