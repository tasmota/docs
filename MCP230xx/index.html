<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation (Wiki) for Tasmota"><link href=https://tasmota.github.io/docs/MCP230xx/ rel=canonical><link rel=icon href=../_media/favicon.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.3"><title>MCP23008 / MCP23017 GPIO Expander - Tasmota</title><link rel=stylesheet href=../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Barlow:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Barlow";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/css/anchor-fix.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-8J08F8X90S"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-8J08F8X90S",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-8J08F8X90S",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#mcp23008-mcp23017-gpio-expander class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title=Tasmota class="md-header__button md-logo" aria-label=Tasmota data-md-component=logo> <img src=../_media/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Tasmota </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> MCP23008 / MCP23017 GPIO Expander </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue data-md-color-accent=deep-purple aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/arendst/tasmota title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> arendst/tasmota </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../Features/ class=md-tabs__link> Features </a> </li> <li class=md-tabs__item> <a href=../ESP32/ class=md-tabs__link> ESP32 </a> </li> <li class=md-tabs__item> <a href=../Integrations/ class=md-tabs__link> Smart Home Integrations </a> </li> <li class=md-tabs__item> <a href=../Supported-Peripherals/ class=md-tabs__link> Peripherals </a> </li> <li class=md-tabs__item> <a href=../Configuration-Procedure-for-New-Devices/ class=md-tabs__link> Supported Devices </a> </li> <li class=md-tabs__item> <a href=../FAQ/ class=md-tabs__link> Help </a> </li> <li class=md-tabs__item> <a href=http://tasmota.github.io/install class=md-tabs__link> Web Installer </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=Tasmota class="md-nav__button md-logo" aria-label=Tasmota data-md-component=logo> <img src=../_media/logo.svg alt=logo> </a> Tasmota </label> <div class=md-nav__source> <a href=https://github.com/arendst/tasmota title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> arendst/tasmota </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> News </span> </a> </li> <li class=md-nav__item> <a href=../About/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class=md-nav__item> <a href=../Getting-Started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=../Upgrading/ class=md-nav__link> <span class=md-ellipsis> Upgrading </span> </a> </li> <li class=md-nav__item> <a href=../MQTT/ class=md-nav__link> <span class=md-ellipsis> MQTT </span> </a> </li> <li class=md-nav__item> <a href=../Commands/ class=md-nav__link> <span class=md-ellipsis> Commands </span> </a> </li> <li class=md-nav__item> <a href=../Templates/ class=md-nav__link> <span class=md-ellipsis> Templates </span> </a> </li> <li class=md-nav__item> <a href=../Components/ class=md-nav__link> <span class=md-ellipsis> Components </span> </a> </li> <li class=md-nav__item> <a href=../Modules/ class=md-nav__link> <span class=md-ellipsis> Modules </span> </a> </li> <li class=md-nav__item> <a href=../Peripherals/ class=md-nav__link> <span class=md-ellipsis> Peripherals </span> </a> </li> <li class=md-nav__item> <a href=../WebUI/ class=md-nav__link> <span class=md-ellipsis> WebUI </span> </a> </li> <li class=md-nav__item> <a href=../Firmware-Builds/ class=md-nav__link> <span class=md-ellipsis> Firmware Builds </span> </a> </li> <li class=md-nav__item> <a href=../Compile-your-build/ class=md-nav__link> <span class=md-ellipsis> Compiling </span> </a> </li> <li class=md-nav__item> <a href=../Contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../Download/ class=md-nav__link> <span class=md-ellipsis> Download </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/arendst/Tasmota/discussions/categories/show-and-tell class=md-nav__link> <span class=md-ellipsis> Project Showcase </span> </a> </li> <li class=md-nav__item> <a href=../For-Developers/ class=md-nav__link> <span class=md-ellipsis> For Developers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Features/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../ADC/ class=md-nav__link> <span class=md-ellipsis> Analog Pin </span> </a> </li> <li class=md-nav__item> <a href=../ArtNet/ class=md-nav__link> <span class=md-ellipsis> ArtNet DMX </span> </a> </li> <li class=md-nav__item> <a href=../Buttons-and-Switches/ class=md-nav__link> <span class=md-ellipsis> Buttons and Switches </span> </a> </li> <li class=md-nav__item> <a href=../DeepSleep/ class=md-nav__link> <span class=md-ellipsis> DeepSleep </span> </a> </li> <li class=md-nav__item> <a href=../Device-Groups/ class=md-nav__link> <span class=md-ellipsis> Device Groups </span> </a> </li> <li class=md-nav__item> <a href=../Universal-Display-Driver/ class=md-nav__link> <span class=md-ellipsis> Universal Display and Universal Touch drivers (uDisplay/uTouch) </span> </a> </li> <li class=md-nav__item> <a href=../Displays/ class=md-nav__link> <span class=md-ellipsis> Displays </span> </a> </li> <li class=md-nav__item> <a href=../Dynamic-Sleep/ class=md-nav__link> <span class=md-ellipsis> Dynamic Sleep </span> </a> </li> <li class=md-nav__item> <a href=../I2CDEVICES/ class=md-nav__link> <span class=md-ellipsis> I2C Devices </span> </a> </li> <li class=md-nav__item> <a href=../I2S-Audio/ class=md-nav__link> <span class=md-ellipsis> I2S Audio </span> </a> </li> <li class=md-nav__item> <a href=../IPv6/ class=md-nav__link> <span class=md-ellipsis> IPv6 </span> </a> </li> <li class=md-nav__item> <a href=../Lights/ class=md-nav__link> <span class=md-ellipsis> Lights </span> </a> </li> <li class=md-nav__item> <a href=../Matter/ class=md-nav__link> <span class=md-ellipsis> Matter </span> </a> </li> <li class=md-nav__item> <a href=../PIR-Motion-Sensors/ class=md-nav__link> <span class=md-ellipsis> PIR Motion Sensors </span> </a> </li> <li class=md-nav__item> <a href=../Power-Monitoring-Calibration/ class=md-nav__link> <span class=md-ellipsis> Power Monitoring Calibration </span> </a> </li> <li class=md-nav__item> <a href=../PWM-dimmer-switch/ class=md-nav__link> <span class=md-ellipsis> PWM Dimmer </span> </a> </li> <li class=md-nav__item> <a href=../Rules/ class=md-nav__link> <span class=md-ellipsis> Rules </span> </a> </li> <li class=md-nav__item> <a href=../Scripting-Language/ class=md-nav__link> <span class=md-ellipsis> Scripting Language </span> </a> </li> <li class=md-nav__item> <a href=../Blinds-and-Shutters/ class=md-nav__link> <span class=md-ellipsis> Shutters and Blinds </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_21> <label class=md-nav__link for=__nav_2_21 id=__nav_2_21_label tabindex=0> <span class=md-ellipsis> Protocol Bridging </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_21_label aria-expanded=false> <label class=md-nav__title for=__nav_2_21> <span class="md-nav__icon md-icon"></span> Protocol Bridging </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../TasmotaClient/ class=md-nav__link> <span class=md-ellipsis> Arduino MCU </span> </a> </li> <li class=md-nav__item> <a href=../Bluetooth/ class=md-nav__link> <span class=md-ellipsis> BLE Gateway </span> </a> </li> <li class=md-nav__item> <a href=../DALI/ class=md-nav__link> <span class=md-ellipsis> DALI </span> </a> </li> <li class=md-nav__item> <a href=../HDMI_CEC/ class=md-nav__link> <span class=md-ellipsis> HDMI CEC </span> </a> </li> <li class=md-nav__item> <a href=../Tasmota-IR/ class=md-nav__link> <span class=md-ellipsis> IR Communication </span> </a> </li> <li class=md-nav__item> <a href=../Projector/ class=md-nav__link> <span class=md-ellipsis> LCD/DLP Projector Control </span> </a> </li> <li class=md-nav__item> <a href=../LoRa-and-LoRaWan-Bridge/ class=md-nav__link> <span class=md-ellipsis> LoRa and LoRaWan Bridge </span> </a> </li> <li class=md-nav__item> <a href=../Modbus-Bridge/ class=md-nav__link> <span class=md-ellipsis> Modbus Bridge </span> </a> </li> <li class=md-nav__item> <a href=../OpenTherm/ class=md-nav__link> <span class=md-ellipsis> OpenTherm </span> </a> </li> <li class=md-nav__item> <a href=../RF-Protocol/ class=md-nav__link> <span class=md-ellipsis> RF Communication </span> </a> </li> <li class=md-nav__item> <a href=../Serial-to-TCP-Bridge/ class=md-nav__link> <span class=md-ellipsis> Serial to TCP Bridge </span> </a> </li> <li class=md-nav__item> <a href=../TWAI/ class=md-nav__link> <span class=md-ellipsis> TWAI </span> </a> </li> <li class=md-nav__item> <a href=../Telegram/ class=md-nav__link> <span class=md-ellipsis> Telegram </span> </a> </li> <li class=md-nav__item> <a href=../Zigbee/ class=md-nav__link> <span class=md-ellipsis> Zigbee </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Smart-Meter-Interface/ class=md-nav__link> <span class=md-ellipsis> Smart Meter Interface </span> </a> </li> <li class=md-nav__item> <a href=../Thermostat/ class=md-nav__link> <span class=md-ellipsis> Thermostat </span> </a> </li> <li class=md-nav__item> <a href=../Timers/ class=md-nav__link> <span class=md-ellipsis> Timers </span> </a> </li> <li class=md-nav__item> <a href=../TLS/ class=md-nav__link> <span class=md-ellipsis> TLS Secured MQTT </span> </a> </li> <li class=md-nav__item> <a href=../TuyaMCU/ class=md-nav__link> <span class=md-ellipsis> TuyaMCU </span> </a> </li> <li class=md-nav__item> <a href=../UFS/ class=md-nav__link> <span class=md-ellipsis> Universal File System </span> </a> </li> <li class=md-nav__item> <a href=../Range-Extender/ class=md-nav__link> <span class=md-ellipsis> Wi-Fi Range Extender </span> </a> </li> <li class=md-nav__item> <a href=../Wireguard/ class=md-nav__link> <span class=md-ellipsis> Wireguard VPN </span> </a> </li> <li class=md-nav__item> <a href=../Tutorials/ class=md-nav__link> <span class=md-ellipsis> Projects and Tutorials </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> ESP32 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> ESP32 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ESP32/ class=md-nav__link> <span class=md-ellipsis> Tasmota32 Features </span> </a> </li> <li class=md-nav__item> <a href=../Berry/ class=md-nav__link> <span class=md-ellipsis> Berry </span> </a> </li> <li class=md-nav__item> <a href=../Bluetooth_ESP32/ class=md-nav__link> <span class=md-ellipsis> Bluetooth Low Energy </span> </a> </li> <li class=md-nav__item> <a href=../LVGL/ class=md-nav__link> <span class=md-ellipsis> LVGL </span> </a> </li> <li class=md-nav__item> <a href=../HASPmota/ class=md-nav__link> <span class=md-ellipsis> HASPmota </span> </a> </li> <li class=md-nav__item> <a href=../Matter/ class=md-nav__link> <span class=md-ellipsis> Matter </span> </a> </li> <li class=md-nav__item> <a href=../Tasmota-Extension/ class=md-nav__link> <span class=md-ellipsis> Tasmota Extension </span> </a> </li> <li class=md-nav__item> <a href=../Tasmota-Application/ class=md-nav__link> <span class=md-ellipsis> Tasmota Application Files </span> </a> </li> <li class=md-nav__item> <a href=../TFL/ class=md-nav__link> <span class=md-ellipsis> TensorFlow Lite </span> </a> </li> <li class=md-nav__item> <a href=../TouchPin/ class=md-nav__link> <span class=md-ellipsis> Touch GPIOs </span> </a> </li> <li class=md-nav__item> <a href=../Safeboot/ class=md-nav__link> <span class=md-ellipsis> Safeboot Partition Layout </span> </a> </li> <li class=md-nav__item> <a href=https://templates.blakadder.com/esp32 class=md-nav__link> <span class=md-ellipsis> Supported Devices </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Smart Home Integrations </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Smart Home Integrations </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Integrations/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../Alexa/ class=md-nav__link> <span class=md-ellipsis> Alexa </span> </a> </li> <li class=md-nav__item> <a href=../AWS-IoT/ class=md-nav__link> <span class=md-ellipsis> AWS IoT </span> </a> </li> <li class=md-nav__item> <a href=../Domoticz/ class=md-nav__link> <span class=md-ellipsis> Domoticz </span> </a> </li> <li class=md-nav__item> <a href=../Home-Assistant/ class=md-nav__link> <span class=md-ellipsis> Home Assistant </span> </a> </li> <li class=md-nav__item> <a href=../Homebridge/ class=md-nav__link> <span class=md-ellipsis> Homebridge </span> </a> </li> <li class=md-nav__item> <a href=https://homey.app/en-us/app/com.paveld.tasmota/Tasmota-MQTT/ class=md-nav__link> <span class=md-ellipsis> Homey </span> </a> </li> <li class=md-nav__item> <a href=../HomeSeer/ class=md-nav__link> <span class=md-ellipsis> HomeSeer </span> </a> </li> <li class=md-nav__item> <a href=../IP-Symcon/ class=md-nav__link> <span class=md-ellipsis> IP Symcon </span> </a> </li> <li class=md-nav__item> <a href=../KNX/ class=md-nav__link> <span class=md-ellipsis> KNX </span> </a> </li> <li class=md-nav__item> <a href=../NodeRed/ class=md-nav__link> <span class=md-ellipsis> NodeRed </span> </a> </li> <li class=md-nav__item> <a href=../nymea/ class=md-nav__link> <span class=md-ellipsis> nymea </span> </a> </li> <li class=md-nav__item> <a href=../Octoprint/ class=md-nav__link> <span class=md-ellipsis> OctoPrint </span> </a> </li> <li class=md-nav__item> <a href=../openHAB/ class=md-nav__link> <span class=md-ellipsis> openHAB </span> </a> </li> <li class=md-nav__item> <a href=../otto/ class=md-nav__link> <span class=md-ellipsis> Otto </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/arendst/Tasmota/issues/3769 class=md-nav__link> <span class=md-ellipsis> IOBroker </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/tim-hellhake/tasmota-adapter class=md-nav__link> <span class=md-ellipsis> Mozilla WebThings Adapter </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/hongtat/tasmota-connect class=md-nav__link> <span class=md-ellipsis> SmartThings </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/Gifford47/tasmohab/blob/master/README.md class=md-nav__link> <span class=md-ellipsis> Tasmohab </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Supported-Peripherals/ class=md-nav__link> <span class=md-ellipsis> Peripherals </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Supported Devices </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Supported Devices </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../Configuration-Procedure-for-New-Devices/ class=md-nav__link> <span class=md-ellipsis> Configure Unknown Device </span> </a> </li> <li class=md-nav__item> <a href="https://templates.blakadder.com/ " target='_blank""' class=md-nav__link> <span class=md-ellipsis> All Supported Devices </span> </a> </li> <li class=md-nav__item> <a href=../Pinouts/ class=md-nav__link> <span class=md-ellipsis> Wi-Fi Module Pinouts </span> </a> </li> <li class=md-nav__item> <a href=../Supported-Modules/ class=md-nav__link> <span class=md-ellipsis> Supported Modules </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> Help </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Help </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../FAQ/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class=md-nav__item> <a href=../Troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> <li class=md-nav__item> <a href=../Device-Recovery/ class=md-nav__link> <span class=md-ellipsis> Device Recovery </span> </a> </li> <li class=md-nav__item> <a href="https://discord.gg/Ks2Kzd4 " target='_blank""' class=md-nav__link> <span class=md-ellipsis> Discord Support </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=http://tasmota.github.io/install class=md-nav__link> <span class=md-ellipsis> Web Installer </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#supporting-modes class=md-nav__link> <span class=md-ellipsis> Supporting modes </span> </a> </li> <li class=md-nav__item> <a href=#mode-2 class=md-nav__link> <span class=md-ellipsis> Mode 2 </span> </a> </li> <li class=md-nav__item> <a href=#mode-1 class=md-nav__link> <span class=md-ellipsis> Mode 1 </span> </a> </li> <li class=md-nav__item> <a href=#mcp23008-mcp23017-pin-numbers-in-tasmota-compared-to-datasheets class=md-nav__link> <span class=md-ellipsis> MCP23008 / MCP23017 Pin numbers in Tasmota compared to datasheets </span> </a> </li> <li class=md-nav__item> <a href=#usage-of-the-driver class=md-nav__link> <span class=md-ellipsis> Usage of the driver </span> </a> </li> <li class=md-nav__item> <a href=#device-configuration class=md-nav__link> <span class=md-ellipsis> Device Configuration </span> </a> <nav class=md-nav aria-label="Device Configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#important-notice-on-use-of-interrupts class=md-nav__link> <span class=md-ellipsis> IMPORTANT NOTICE ON USE OF INTERRUPTS </span> </a> </li> <li class=md-nav__item> <a href=#interrupt-modes-and-usage class=md-nav__link> <span class=md-ellipsis> INTERRUPT MODES AND USAGE </span> </a> </li> <li class=md-nav__item> <a href=#home-assistant-tips class=md-nav__link> <span class=md-ellipsis> HOME ASSISTANT TIPS </span> </a> </li> <li class=md-nav__item> <a href=#advanced-functions class=md-nav__link> <span class=md-ellipsis> ADVANCED FUNCTIONS </span> </a> </li> <li class=md-nav__item> <a href=#advanced-function-1-interrupt-priority-intpri class=md-nav__link> <span class=md-ellipsis> ADVANCED FUNCTION #1 - INTERRUPT PRIORITY (INTPRI) </span> </a> </li> <li class=md-nav__item> <a href=#advanced-function-2-interrupt-defer-intdef class=md-nav__link> <span class=md-ellipsis> ADVANCED FUNCTION #2 - INTERRUPT DEFER (INTDEF) </span> </a> </li> <li class=md-nav__item> <a href=#advanced-function-3-interrupt-timer-inttimer class=md-nav__link> <span class=md-ellipsis> ADVANCED FUNCTION #3 - INTERRUPT TIMER (INTTIMER) </span> </a> </li> <li class=md-nav__item> <a href=#advanced-function-4-interrupt-counter-enable-intcnt class=md-nav__link> <span class=md-ellipsis> ADVANCED FUNCTION #4 - INTERRUPT COUNTER ENABLE (INTCNT) </span> </a> </li> <li class=md-nav__item> <a href=#advanced-function-5-interrupt-retain-intretain class=md-nav__link> <span class=md-ellipsis> ADVANCED FUNCTION #5 - INTERRUPT RETAIN (INTRETAIN) </span> </a> </li> <li class=md-nav__item> <a href=#output-functions-pin-modes-5-and-6 class=md-nav__link> <span class=md-ellipsis> OUTPUT FUNCTIONS (PIN MODES 5 AND 6) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/tasmota/docs/blob/master/docs/MCP230xx.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <h1 id=mcp23008-mcp23017-gpio-expander>MCP23008 / MCP23017 GPIO Expander<a class=headerlink href=#mcp23008-mcp23017-gpio-expander title="Permanent link">~</a></h1> <p>Technical Data from the manufacturer: * Microchip <a href=https://www.microchip.com/wwwproducts/en/MCP23008>MCP23008</a> * Microchip <a href=https://www.microchip.com/wwwproducts/en/MCP23017>MCP23017</a></p> <p>Generally available breakout boards for the MCP23017 look similar to this:</p> <p><img alt=https://github.com/andrethomas/images/raw/master/mcp230xx/mcp23017_breakout.jpg src=https://github.com/andrethomas/images/raw/master/mcp230xx/mcp23017_breakout.jpg></p> <p>The MCP23008 has 8 IO pins which the MCP230xx driver uses as D0 - D7. The MCP23017 has 16 IO pins which the MCP230xx driver uses as D0 - D15. This is visualized in the circuit diagram below but it's important to note that the MCP23017 actually differentiates between PORTA (being A0 to A7) and PORTB (being B0 to B7) - The MCP230xx driver combines the two ports in sequence to translate to pins represented as D0 through D15 for the MCP23017.</p> <p>The chip can be connected quite easily, especially if you can source the DIP version of the chip. Here's a basic outline of what a typical circuit would require to be functional:</p> <p><img alt="Manual Wiring for MCP23008 / MCP23017" src=https://github.com/andrethomas/images/raw/master/mcp230xx/mcp230xx_manual_wiring_v2.png></p> <p>You will need to pick an I2C address in either of the above scenario's using the address mapping according to pin A0, A1, and A2 as from the datasheet as follows:</p> <p><img alt="MCP23008 / MCP23017 I2C Address Map" src=https://github.com/andrethomas/images/raw/master/mcp230xx/i2c_address_map.png></p> <h3 id=supporting-modes>Supporting modes<a class=headerlink href=#supporting-modes title="Permanent link">~</a></h3> <p>Starting with Tasmota v12.4.0.2 there are two different modes to use MCP23xxx.</p> <ul> <li>The original approach (now called Mode 1) supports one MCP23008 or MCP23017 with many user configurable features using commands and rules. </li> <li>The latest approach called Mode 2, supports several and mixed MCP23008, MCP23017 and MCP23S17 adding switches, buttons and relays acted on as if they were directly connected to the ESP8266 or ESP32 configured using a JSON file containing a template describing the GPIO's as used on the basic Tasmota device.</li> </ul> <h3 id=mode-2>Mode 2<a class=headerlink href=#mode-2 title="Permanent link">~</a></h3> <p>To enable Mode 2 you will only need to add in <code>user_config_override.h</code> </p> <p><code>#define USE_MCP23XXX_DRV</code></p> <p>This enables the driver which in turn at restart will search for the JSON file in three possible locations:</p> <ul> <li>if a filesystem is present it looks for file <code>mcp23x.dat</code></li> <li>if not found and rules are supported it looks for a specific rule entry like <code>on file#mcp23x.dat do &lt;template&gt; endon</code></li> <li>if not found and scripts are supported it looks for a specific script like <code>-y &lt;template&gt;</code></li> </ul> <p>If no JSON file is found the driver does not claim any MCP23xxx device and if mode 1 is enabled will allow this mode to take over.</p> <p>A typical JSON template would look like <code>{"NAME":"MCP23008 expander","BASE":0,"GPIO":[224,225,226,227,32,33,34,35]}</code> which adds four relays and four buttons.</p> <p>The template consists of a <code>"NAME"</code> data pair with any description of the template, an optional <code>"BASE"</code> data pair selecting if either relative (0 = default) or absolute (1) button and/or switch numbering is used and a <code>"GPIO"</code> data pair with numbers representing the functions of the GPIO's in order from lowest I2C address GP(A)0 to highest I2C address GP(B)7 and are based on the numbers known from the base tasmota template used on the ESP8266 or ESP32.</p> <p>The following list contains the current supported functions:</p> <table> <thead> <tr> <th>Function</th> <th></th> <th>Code</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>None</td> <td></td> <td>0</td> <td>Not used</td> </tr> <tr> <td>Button1..32</td> <td>B</td> <td>32..63</td> <td>Button to Gnd with internal pullup</td> </tr> <tr> <td>Button_n1..32</td> <td>Bn</td> <td>64..95</td> <td>Button to Gnd without internal pullup</td> </tr> <tr> <td>Button_i1..32</td> <td>Bi</td> <td>96..127</td> <td>Button inverted to Vcc with internal pullup</td> </tr> <tr> <td>Button_in1..32</td> <td>Bin</td> <td>128..159</td> <td>Button inverted to Vcc without internal pullup</td> </tr> <tr> <td>Switch1..28</td> <td>S</td> <td>160..187</td> <td>Switch to Gnd with internal pullup</td> </tr> <tr> <td>Switch_n1..28</td> <td>Sn</td> <td>192..219</td> <td>Switch to Gnd without internal pullup</td> </tr> <tr> <td>Relay1..32</td> <td>R</td> <td>224..255</td> <td>Relay</td> </tr> <tr> <td>Relay_i1..32</td> <td>Ri</td> <td>256..287</td> <td>Relay inverted</td> </tr> <tr> <td>Output_Hi</td> <td>Oh</td> <td>3840</td> <td>Fixed output high</td> </tr> <tr> <td>Output_lo</td> <td>Ol</td> <td>3872</td> <td>Fixed output low</td> </tr> </tbody> </table> <p>Some example templates</p> <div class=highlight><pre><span></span><code>                                          S3  S2  B2 B3 Oh   B1 S1    R1        R4  R2  R3  S4
{&quot;NAME&quot;:&quot;MCP23S17 Shelly Pro 4PM&quot;,&quot;GPIO&quot;:[194,193,65,66,3840,64,192,0,224,0,0,0,227,225,226,195]}

Inverted relays and buttons                Ri1 Ri2 Ri3 Ri4 Ri5 Ri6 Ri7 Ri8 B1 B2 B3 B4 B5 B6 B7 B8
{&quot;NAME&quot;:&quot;MCP23017 A=Ri1-8, B=B1-8&quot;,&quot;GPIO&quot;:[256,257,258,259,260,261,262,263,32,33,34,35,36,37,38,39]}

Unique inverted relays and buttons with offset 2      Ri3 Ri4 Ri5 Ri6 Ri7 Ri8 Ri9 Ri10B3 B4 B5 B6 B7 B8 B9 B10
{&quot;NAME&quot;:&quot;MCP23017 A=Ri2-10, B=B2-10&quot;,&quot;BASE&quot;:1,&quot;GPIO&quot;:[258,259,260,261,262,263,264,265,34,35,36,37,38,39,40,41]}

Buttons, relays, buttons and relays                         B1 B2 B3 B4 B5 B6 B7 B8 R1  R2  R3  R4  R5  R6  R7  R8  B9 B10B11B12B13B14B15B16R9  R10 R11 R12 R13 R14 R15 R16
{&quot;NAME&quot;:&quot;MCP23017 A=B1-8, B=R1-8, C=B9-16, D=R9-16&quot;,&quot;GPIO&quot;:[32,33,34,35,36,37,38,39,224,225,226,227,228,229,230,231,40,41,42,43,44,45,46,47,232,233,234,235,236,237,238,239]}
</code></pre></div> <h4 id=interrupt-pins>Interrupt Pins<a class=headerlink href=#interrupt-pins title="Permanent link">~</a></h4> <p>In Mode 2 you can choose to connect the interrupt pins from the MCP230xx to native GPIOs on the ESP. You will then need to configure the used GPIOs as "MCP23xxx Int" in the Web UI. This way, upon a change in an input, the corresponding interrupt pin will gererate a flag that will be scanned at every program cycle, making the detection as fast as possible. If not using the interrupt pins the detection will be triggered every 50ms.</p> <p>The MCP23017 has two interrupt pins, one for each I/O bank. By default they are configured as mirrored: both interrupt pins will activate whenever an input changes state in either bank A or bank B. Starting from Tasmota v14.4.1, different behaviour for the interrupt pins can be achieved by changing the configuration of the IOCON configuration registes. For this, the optional key pair "IOCON" must be added to the MCP23017 template. See the example below:</p> <div class=highlight><pre><span></span><code> * Buttons and relays with open-drain INT    B1 B2 B3 B4 B5 B6 B7 B8 R1  R2  R3  R4  R5  R6  R7  R8
 * {&quot;NAME&quot;:&quot;MCP23017 A=B1-8, B=R1-8&quot;,&quot;GPIO&quot;:[32,33,34,35,36,37,38,39,224,225,226,227,228,229,230,231],&quot;IOCON&quot;:0x5C}
</code></pre></div> <p>Configurable options are (* indicates the default):</p> <div class=highlight><pre><span></span><code>bit 7: 0 (not configurable)

bit 6
MIRROR: INT Pins Mirror bit
1* = The INT pins are internally connected
0 = The INT pins are not connected. INTA is associated with PORTA and INTB is associated with
PORTB

bit 5: 0 (not configurable)

bit 4
1* = Slew rate disabled
0 = Slew rate enabled

bit 3
HAEN: Hardware Address Enable bit (MCP23S17 only) (Note 1)
1* = Enables the MCP23S17 address pins.
0 = Disables the MCP23S17 address pins.

bit 2
ODR: Configures the INT pin as an open-drain output
1 = Open-drain output (overrides the INTPOL bit.)
0* = Active driver output (INTPOL bit sets the polarity.)

bit 1
INTPOL: This bit sets the polarity of the INT output pin
1 = Active-high
0* = Active-low

bit 0: 0 (not configurable)
</code></pre></div> <p>Default configuration is 0b01011000 = 0x58. For more information refer to the MCP23017/MCP23S17 datasheet.</p> <h3 id=mode-1>Mode 1<a class=headerlink href=#mode-1 title="Permanent link">~</a></h3> <p>You will need to define the address you are using in <code>user_config_override.h</code> for the driver to know on which address the MCP23008/MCP23017 is expected to be found.</p> <p><code>#define USE_MCP230xx_ADDR 0x20</code></p> <p>The MCP23008/MCP23017 chips allow for both INPUT and OUTPUT - Most of the functionality of the driver is focused on INPUT mode - especially since they allow interrupt reporting and are 5V tolerant.</p> <p>OUTPUT functionality is however available as pinmode 5 (Documented later in this Wiki) as an additional option for those who want to use the OUTPUT functionality using the <code>Sensor29</code> command which consumes ~1Kbyte of flash. The driver is disabled by default in the Tasmota firmware so the only way to gain its use would be to perform a manual compilation of your own firmware.</p> <p>There are three different levels in which functionality may be enabled, in the following order, by adding these lines in <code>user_config_override.h</code>: <div class=highlight><pre><span></span><code>#define USE_MCP230xx                 // Enable INPUT mode (pinmode 1 through 4)
#define USE_MCP230xx_OUTPUT          // Enable OUTPUT mode (pinmode 5)
#define USE_MCP230xx_DISPLAYOUTPUT   // Display state of OUTPUT pins on main Tasmota web interface
</code></pre></div></p> <p>The ESP8266 will automatically detect whether you have connected an MCP23008 (8 input) or MCP23017 (16 input) and will provide telemetry data in accordance with how the device was configured from within the Tasmota firmware.</p> <p>If OUTPUT is enabled, telemetry data for the current state of OUTPUT pins will also be provided by telemetry.</p> <h3 id=mcp23008-mcp23017-pin-numbers-in-tasmota-compared-to-datasheets>MCP23008 / MCP23017 Pin numbers in Tasmota compared to datasheets<a class=headerlink href=#mcp23008-mcp23017-pin-numbers-in-tasmota-compared-to-datasheets title="Permanent link">~</a></h3> <p>The table below outlines how the pins of the MCP23008/MCP23017 are assigned:</p> <p><img alt="MCP23008 / MCP23017 Pin Map" src=https://github.com/andrethomas/images/raw/master/mcp230xx/mcp_pin_mapping.PNG></p> <h3 id=usage-of-the-driver>Usage of the driver<a class=headerlink href=#usage-of-the-driver title="Permanent link">~</a></h3> <p>The MCP230xx chip (or breakout board) must be connected to the ESP8266 and the I2C pins must be configured for the module similar to the following:</p> <p><img alt=https://github.com/andrethomas/images/raw/master/mcp230xx/Generic_Config_Menu.PNG src=https://github.com/andrethomas/images/raw/master/mcp230xx/Generic_Config_Menu.PNG></p> <p>One that is complete you may want to confirm that the Tasmota firmware is finding your MCP23008/MCP23017 chip by sending the command through serial or MQTT:<br> <code>I2Cscan</code></p> <p>You should see a response giving you an address within the range of the MCP23008/MCP23017 chip (0x20 through 0x27) which may look as follows<br> <code>MQT: stat/tasmota/RESULT = {"I2CScan":"Device(s) found at 0x20"}</code></p> <p>If the extender is not detected, check your wiring and pin configuration.</p> <p>The configuration of MCP23008/MCP23017 by using <code>Sensor29</code> commands via the Console or MQTT messages.</p> <p>In order to use the MCP23008/MCP23017, add the following two lines in your <code>user_config_override.h</code> as the MCP chip support is not enabled by default.<br> <div class=highlight><pre><span></span><code>#define USE_MCP230xx
#define USE_MCP230xx_ADDR 0x20
</code></pre></div></p> <p>The MCP23008/MCP23017 supports I<sup>2</sup>C address range of 0x20 through 0x27. Take care that you are not using an address which is already used by another device (e.g., 0x27 is a known address for some I<sup>2</sup>C Liquid Crystal Displays).</p> <h2 id=device-configuration>Device Configuration<a class=headerlink href=#device-configuration title="Permanent link">~</a></h2> <p>The behavior of all pins on the MCP23008/MCP23017 can be reset to a specific setting/mode globally to simplify the initial configuration as follows</p> <table> <thead> <tr> <th>Command</th> <th>Parameters</th> </tr> </thead> <tbody> <tr> <td>Sensor29<a id=Sensor29></a></td> <td>MCP23008 / MCP23017 I<sup>2</sup>C GPIO Expander configuration<br><code>Reset&lt;x&gt;</code> = reset all pins<br>x = <code>1..6</code><br><code>1</code> = INPUT mode, no reporting, no pull-up<br><code>2</code> = INPUT mode, report on CHANGE, pull-up enabled<br><code>3</code> = INPUT mode, report on LOW, pull-up enabled<br><code>4</code> = INPUT mode, report on HIGH, pull-up enabled<br><code>5</code> = OUTPUT mode (if enabled by <code>#define USE_MCP230xx_OUTPUT</code>)<br><code>6</code> = inverted OUTPUT mode (if enabled by <code>#define USE_MCP230xx_OUTPUT</code>)<br><br><code>pin,pinmode{,intpullup\|outstate{,repmode}}</code><ul></ul><code>pin</code> = the I/O pin on the MCP230xx chip<ul><li><code>0..7</code> for MCP23008</li><li><code>0..15</code> for the MCP23017)</ul><code>pinmode</code> = operational mode of the pin (<code>?, 0..5</code>)<ul><li><code>?</code> = query pin configuration</li><li><code>0</code> = Disabled (deprecated, but will be default for previously unconfigured devices)</li><li><code>1</code> = INPUT (Floating - only telemetry data will be sent according to configuration <code>TelePeriod</code> intervals)</li><li><code>2</code> = INPUT with INTERRUPT on CHANGE (will send an MQTT output on state change from LOW to HIGH <strong>and</strong> HIGH to LOW)</li><li><code>3</code> = INPUT with INTERRUPT on CHANGE to <strong>LOW</strong> (will send an MQTT output on state change <strong>only</strong> from HIGH to LOW)</li><li><code>4</code> = INPUT with INTERRUPT on CHANGE to <strong>HIGH</strong> (will send an MQTT output on state change <strong>only</strong> from LOW to HIGH)</li><li><code>5</code> = OUTPUT (if enabled with <code>#define USE_MCP230xx_OUTPUT</code>)</li><li><code>6</code> = inverted OUTPUT (if enabled with <code>#define USE_MCP230xx_OUTPUT</code>)</li></ul><code>intpullup</code> <em>(pinmode <code>1..4</code>)</em>. Pull-up resistors are disabled by default for pin mode <code>1</code> whilst enabled by default for pin modes <code>2..4</code> (because they are interrupt enabled pins and we do not want signal bounce). The internal pull-up on these pins may be disabled if necessary if you are biasing them externally.<ul><li><code>0</code> = weak internal pull-up disabled <em>(default for pinmode <code>1</code>)</em></li><li><code>1</code> = weak internal pull-up enabled <em>(default for pinmode <code>2..4</code>)</em></li></ul><code>outstate</code> <em>(pinmode <code>5..6</code>)</em> = set the default state of an OUTPUT pin on reset/power-up. If your device is configured to save state (<code>SetOption0 = 1</code>), the <code>outstate</code> setting will be ignored and the last known state of the pin will be applied during power-up/reset.<ul><li><code>0/off</code> = set output pin to OFF</li><li><code>1/on</code> = set output pin state to ON</li><li><code>2/device</code> = keep the value stored on the MCP230xx device</li></ul><code>repmode</code> = reporting mode (optional). Applicable only for pinmode <code>2..4</code>. Reporting mode is disabled for pinmode <code>1</code> and for output pinmodes (<code>5..6</code>)<ul><li><code>0</code> = interrupt using Event and report using telemetry <em>(default)</em></li><li><code>1</code> = interrupt using Event only (no telemetry reported)</li><li><code>2</code> = report using telemetry only (no Event triggered)</li></ul></td> </tr> </tbody> </table> <p>Examples:<br> <code>Sensor29 Reset1</code><br> <code>MQT: stat/tasmota/RESULT = {"Sensor29_D99":{"MODE":1,"PULL_UP":"OFF","INT_MODE":"DISABLED","STATE":""}}</code><br> Pin and State is reported as 99 because it is set across all pins.<br> Mode should correspond with the reset pinmode option used. </p> <p><code>Sensor29 0,?</code><br> <code>MQT: stat/tasmota/RESULT = {"Sensor29_D0":{"MODE":1,"PULL_UP":"OFF","INT_MODE":"DISABLED","STATE":"ON"}}</code><br> Confirming that the pin is in pinmode 1 and that the pull-up resistor is not enabled.<br> INT_MODE indicates the interrupt mode for pins which are interrupt enabled (pinmode 2 through 4) - In the example above it is disabled for pin mode 1 (INPUT without INTERRUPT)<br> The current STATE of the pin as ON or OFF is reported as at the time the command is issued is also reported. </p> <h3 id=important-notice-on-use-of-interrupts>IMPORTANT NOTICE ON USE OF INTERRUPTS<a class=headerlink href=#important-notice-on-use-of-interrupts title="Permanent link">~</a></h3> <p><strong><em>Only use interrupts on pins which are either explicitly pulled down GND or up to VCC externally as floating pins may cause unintended MQTT responses for pins which are floating. So unless your connected wire/device explicitly pulls the pin to GND or VCC only when conditions of an interrupt would be met it is recommended that you either do not set a pin for an interrupt mode or at least enable pull-up resistors for the unused pins with pullup = 1 when you perform your sensor29 pin,pinmode,pullup command.</em></strong></p> <p>Examples of some pin configuration options:</p> <p><code>sensor29 4,1,0</code> - Will enable D4 for INPUT without internal pull-up resistor</p> <p><code>sensor29 3,1,1</code> - Will enable D3 for INPUT with the internal pull-up resistor ENABLED</p> <p><code>sensor29 5,2,1</code> - Will enable D5 for INPUT and report on change state from LOW to HIGH and HIGH to LOW via MQTT</p> <p><code>sensor29 6,3,1</code> - Will enable D6 for INPUT and report on change state from HIGH to LOW (note pull-up is also enabled)</p> <p><code>sensor29 2,4,0</code> - Will enable D2 for INPUT and report on change state from LOW to HIGH (note pull-up is not enabled)</p> <p>Pull-up resistor support is valid for all modes from 1 through 4</p> <p>Default telemetry logging will occur for all pins as per the configured logging interval of the ESP8266 as configured in the Tasmota firmware options. The telemetry logging will push out to log and MQTT a JSON as follows: <div class=highlight><pre><span></span><code>tele/tasmota/SENSOR = {&quot;Time&quot;:&quot;2018-08-18T16:13:47&quot;,&quot;MCP230XX&quot;: &quot;D0&quot;:0,&quot;D1&quot;:0,&quot;D2&quot;:1,&quot;D3&quot;:0,&quot;D4&quot;:0,&quot;D5&quot;:0,&quot;D6&quot;:0,&quot;D7&quot;:1}}
</code></pre></div></p> <p>Again, this will depend on whether an MCP23008 or MCP23017 is used insofar that the number of pins/bits reported will be 8 (0 to 7) or 16 (0 to 15) respectively.</p> <h3 id=interrupt-modes-and-usage>INTERRUPT MODES AND USAGE<a class=headerlink href=#interrupt-modes-and-usage title="Permanent link">~</a></h3> <p>Interrupts will report for individual pins as and when the conditions which were configured are met and will look something like this:</p> <p>Interrupt message on HIGH for input pin 0 <div class=highlight><pre><span></span><code>MQT: stat/tasmota/RESULT = {&quot;Time&quot;:&quot;2018-08-19T16:04:50&quot;,&quot;MCP230XX_INT&quot;:{&quot;D0&quot;:1,&quot;MS&quot;:301}}
</code></pre></div> Interrupt message on LOW for input pin 1 <div class=highlight><pre><span></span><code>MQT: stat/tasmota/RESULT = {&quot;Time&quot;:&quot;2018-08-19T16:04:50&quot;,&quot;MCP230XX_INT&quot;:{&quot;D1&quot;:0,&quot;MS&quot;:519}}
</code></pre></div></p> <p>The state of the pin captured during the interrupt is reported as Dx=y where x is the pin number and y is the state of the pin. In addition the number of milliseconds since the last interrupt occurred for the particular pin is also reported as MS=xx where xx is the number of milliseconds recorded.</p> <p>In addition to the MQTT message the driver will also execute an event command in the following format:</p> <p><code>event MCPINT_Dxx=y</code></p> <p>Where xx = the pin number from 0 through 7 (MCP23008) or 0 through 15 (MCP23017) and y the state of the pin as it was captured by the interrupt register of the MCP23008/MCP23017 chip.</p> <p>The complete output for an interrupt enabled pin would look like this:</p> <p><div class=highlight><pre><span></span><code>MQT: stat/tasmota/RESULT = {&quot;Time&quot;:&quot;2018-08-19T16:08:28&quot;,&quot;MCP230XX_INT&quot;:{&quot;D0&quot;:0,&quot;MS&quot;:217353}}
SRC: Rule
RSL: Group 0, Index 1, Command EVENT, Data MCPINT_D0=0
MQT: stat/tasmota/RESULT = {&quot;Event&quot;:&quot;Done&quot;}
</code></pre></div> <div class=highlight><pre><span></span><code>MQT: stat/tasmota/RESULT = {&quot;Time&quot;:&quot;2018-08-19T16:08:46&quot;,&quot;MCP230XX_INT&quot;:{&quot;D0&quot;:1,&quot;MS&quot;:18101}}
SRC: Rule
RSL: Group 0, Index 1, Command EVENT, Data MCPINT_D0=1
MQT: stat/tasmota/RESULT = {&quot;Event&quot;:&quot;Done&quot;}
</code></pre></div></p> <p>The latter makes it possible to integrate interrupt responses with rules for example: <div class=highlight><pre><span></span><code>rule on event#MCPINT_D0=1 do power on endon on event#MCPINT_D0=0 do power off endon
</code></pre></div></p> <p>In the example above the rule would respond to an interrupt of HIGH on pin 0 of the MCP by executing command "power on" and respond to an interrupt of LOW on pin 0 with the command "power off"</p> <p>See the Wiki on <a href=../Rules/ >Using Rules</a> for more information on how this can be helpful to your requirements.</p> <p>If you require only one of the two reporting methods you may use the sensor29 command to configure the interrupt behavior according to your requirements using command:</p> <p><code>sensor29 pin,pinmode,pullup,intmode</code></p> <p>The intmode parameter is optional for pin modes 2 through 4 (those that support interrupts) and may be configured according to the table below depending on your requirements:</p> <p><img alt="MCP23008 / MCP23017 Interrupt Modes" src=https://github.com/andrethomas/images/raw/master/mcp230xx/interrupt_modes_v1.PNG></p> <p><em>Keep in mind that the MCP23008/MCP23017 chip will only store the last interrupt registered in the interrupt register and capture register - Because the interrupt register is only checked every 50 milliseconds by the Tasmota firmware you may experience missed interrupts if your incoming signals fluctuate/change faster than 20 times per second.</em></p> <h3 id=home-assistant-tips>HOME ASSISTANT TIPS<a class=headerlink href=#home-assistant-tips title="Permanent link">~</a></h3> <p>You can use <code>SetOption59 1</code> in order to get extra SENSOR status telemetry messages in addition to event-triggered RESULT messages. This allows very good integration with Home Assistant because it needs to monitor only one payload for both periodic and instant messages using <code>binary_sensor</code>: <div class=highlight><pre><span></span><code>- platform: mqtt
  name: &quot;MCP23017 Teszt D0 SENSOR&quot;
  state_topic: &quot;tele/tasmota/SENSOR&quot;
  value_template: &quot;{{ value_json[&#39;MCP230XX&#39;].D0 }}&quot;
  payload_on: &quot;1&quot;
  payload_off: &quot;0&quot;
  availability_topic: &quot;tele/tasmota/LWT&quot;
  payload_available: &quot;Online&quot;
  payload_not_available: &quot;Offline&quot;
  qos: 0
  device_class: door
</code></pre></div></p> <h3 id=advanced-functions>ADVANCED FUNCTIONS<a class=headerlink href=#advanced-functions title="Permanent link">~</a></h3> <p>Several advanced functions have been added to extend the flexibility and interoperability of the MCP23008/MCP23017 with specific focus on adding functionality which is not present on the hardware's built-in GPIO pins and offloading some of the functionality that would normally be performed by rules or counters on the Tasmota device into the driver of the MCP23008/MCP23017.</p> <p>These include the following * INTPRI - Interrupt Priority, being able to control the rate at which the MCP23008/MCP23017 is polled to see if any interrupts has occurred since the previous poll. * INTDEF - Interrupt Deffer, being able to control the number of interrupts that are ignored on a specific pin before reporting would occur via telemetry and/or EVENT. * INTTIMER - Interrupt Timer which allows for time based counter reporting, specifically reporting the number of times an interrupt has occurred on interrupt enabled pins. * INTCNT - Works with INTTIMER to enable/disable counting for a specific pin. * INTRETAIN - Keep track of whether an interrupt occurred or not and defer reporting to next telemetry message.</p> <p>The above additions are described in further detail below.</p> <h3 id=advanced-function-1-interrupt-priority-intpri>ADVANCED FUNCTION #1 - INTERRUPT PRIORITY (INTPRI)<a class=headerlink href=#advanced-function-1-interrupt-priority-intpri title="Permanent link">~</a></h3> <p>The maximum interrupt polling rate is once per approximately 50 milliseconds - This is what the Tasmota firmware allows as a maximum and how it is configured in the MCP23008/MCP23017 driver by default.</p> <p>If you want to reduce the number of interrupt polls per second you may use the INTPRI command parameter as follows:</p> <p><code>sensor29 intpri</code></p> <p>Will give you the current setting via JSON response as follows:</p> <p><code>MQT: stat/tasmota/RESULT = {"MCP230xx_INTPRI":{"D_99":0}}</code></p> <p>To change the value you may use command as follows:</p> <p><code>sensor29 intpri,x</code></p> <p>Where x is the number of 50ms cycles (between 0 and 20) which will be skipped before the MCP23008/MCP23017 chip is polled for interrupt. The last interrupt recorded by the MCP23008/MCP23017 will be reported via the configured method.</p> <p>For example, lets assume you only want the interrupt polling to occur every 500ms (i.e. twice per second) you could do command:</p> <div class=highlight><pre><span></span><code>sensor29 intpri,10 // interrupt polled every 10*50 milliseconds, approximated
</code></pre></div> <h3 id=advanced-function-2-interrupt-defer-intdef>ADVANCED FUNCTION #2 - INTERRUPT DEFER (INTDEF)<a class=headerlink href=#advanced-function-2-interrupt-defer-intdef title="Permanent link">~</a></h3> <p>This setting is useful if you need to defer the reporting of an interrupt by event or telemetry until it has occurred at least X number of times.</p> <p>Syntax: <div class=highlight><pre><span></span><code>sensor29 intdef,pin         // Will provide current setting of pin
sensor29 intdef,pin,x       // Will set new deffer value to x (0-15)
</code></pre></div></p> <p>Examples: <div class=highlight><pre><span></span><code>sensor29 intdef,pin,5       // Will only report interrupt when it occurs 5 times
sensor29 intdef,pin,10      // Will only report interrupt when it has occurred 10 times
</code></pre></div></p> <p>Interrupts occurring a number of times prior to the setting will be counted but ignored for reporting purposes.</p> <h3 id=advanced-function-3-interrupt-timer-inttimer>ADVANCED FUNCTION #3 - INTERRUPT TIMER (INTTIMER)<a class=headerlink href=#advanced-function-3-interrupt-timer-inttimer title="Permanent link">~</a></h3> <p>This function is used in conjunction with INTCOUNT (Documented below)</p> <p>It allows a timer to be configured over which period the number of interrupts will be counted.</p> <p>Syntax: <div class=highlight><pre><span></span><code>sensor29 inttimer          // Will provide the current amount of seconds for timer
sensor29 inttimer,x        // Allows setting number of seconds (x) for timer interval
</code></pre></div></p> <h3 id=advanced-function-4-interrupt-counter-enable-intcnt>ADVANCED FUNCTION #4 - INTERRUPT COUNTER ENABLE (INTCNT)<a class=headerlink href=#advanced-function-4-interrupt-counter-enable-intcnt title="Permanent link">~</a></h3> <p>Enable interrupt counting for a particular pin. This functionality works in conjunction with INTTIMER (Documented above)</p> <p>Syntax: <div class=highlight><pre><span></span><code>sensor29 intcnt,pin       // Readback current setting of interrupt counting for pin (0=OFF/1=ON)
sensor29 intcnt,pin,x     // Enable/Disable interrupt counting for pin (x=0=OFF,x=1=ON)
</code></pre></div></p> <p>Use case example could be if you want to count the number of times an interrupt occurred on a D0 over a period of 60 seconds. For this we will need the following: <div class=highlight><pre><span></span><code>sensor29 inttimer,60      // Enable interrupt timer for 60 second interval
sensor29 intcnt,0,1       // Enable interrupt counter for pin D0
</code></pre></div></p> <p>The above will result in the number of interrupts that occur within the 60 second period configured to be counted and then reported via telemetry at the end of the 60 second time.</p> <p>A use case for this would be to determine the RPM of something, or perhaps the number of pulses received from an energy meter within a 60 second period to determine energy usage on a per minute bases... or wind speed from impulses received from an anemometer.</p> <h3 id=advanced-function-5-interrupt-retain-intretain>ADVANCED FUNCTION #5 - INTERRUPT RETAIN (INTRETAIN)<a class=headerlink href=#advanced-function-5-interrupt-retain-intretain title="Permanent link">~</a></h3> <p>This functionality disables immediate even and/or telemetry reporting for a specific pin that has been configured for any of the interrupt modes listed above.</p> <p>If this is enabled for a particular pin and the pin has an interrupt mode configured the fact that an interrupt condition was met will be remembered (but not reported immediately) and will be reported in a MQTT message when the next telemetry period occurs in the following format:</p> <div class=highlight><pre><span></span><code>{&quot;Time&quot;:&quot;2018-12-06T23:59:26&quot;,&quot;MCP_INTRETAIN&quot;: {&quot;D0&quot;:1,&quot;D1&quot;:0,&quot;D2&quot;:1,&quot;D3&quot;:1,&quot;D4&quot;:0,&quot;Value&quot;:13}}
</code></pre></div> <p>In the example above it means that an interrupt occurred at some point during the previous telemetry period for pins D0, D2, and D3 as indicated by the 1's present for each pin - Pins with a value of 0 means that although the pin was configured for interrupt retain that no interrupt occurred during the previous telemetry period for that particular pin.</p> <p>For the sake of handling bit-wise operations within your home automation software the decimal value of the respective bits are also aggregated into the Value output included in the telemetry message.</p> <p>Syntax: <div class=highlight><pre><span></span><code>sensor29 intretain,pin       // Readback current setting of interrupt retain for a pin (0=OFF/1=ON)
sensor29 intretain,pin,x     // Enable/Disable interrupt counting for pin (x=0=OFF,x=1=ON)
</code></pre></div></p> <hr> <h3 id=output-functions-pin-modes-5-and-6>OUTPUT FUNCTIONS (PIN MODES 5 AND 6)<a class=headerlink href=#output-functions-pin-modes-5-and-6 title="Permanent link">~</a></h3> <p>Enable OUTPUT support by removing the comment (#) for the following compiler directive to your user_config_override.h</p> <p><code>#define USE_MCP230xx_OUTPUT</code></p> <p>This will extend the sensor29 command enabling pinmode 5 and 6 (inverted) for output, for example (nb. the output state will only be used/set with setoption0 = 0):</p> <div class=highlight><pre><span></span><code>sensor29 0,5,0  // Configure pin 0 as OUTPUT and default to OFF on reset/power-up
sensor29 0,5,1  // Configure pin 0 as OUTPUT and default to ON on reset/power-up
sensor29 0,5,2  // Configure pin 0 as OUTPUT and default to the value read from the MCP230xx on reset/power-up
sensor29 0,6,0  // Configure pin 0 as INVERTED OUTPUT and default to ON on reset/power-up
sensor29 0,6,1  // Configure pin 0 as INVERTED OUTPUT and default to OFF on reset/power-up
sensor29 0,6,2  // Configure pin 0 as INVERTED OUTPUT and default to the value read from the MCP230xx on reset/power-up
</code></pre></div> <p>Confirmation will be sent using MQT, for example: <div class=highlight><pre><span></span><code>MQT: stat/tasmota/RESULT = {&quot;Sensor29_D2&quot;:{&quot;MODE&quot;:5,&quot;START_UP&quot;:&quot;OFF&quot;,&quot;STATE&quot;:&quot;OFF&quot;}}
</code></pre></div></p> <p>The only difference between pinmode 5 and pinmode 6 is that pinmode 5 will result in normal output state, i.e. pin will be LOW when OFF whereas pinmode 6 will cause the pin to be HIGH when OFF. This is useful when using relays which have inverted inputs.</p> <p>If SAVE_STATE / setoption0 is enabled in your firmware configuration then the last known state of the pin will be used on power-up/reset thereby ignoring the pull-up parameter in the commands above.</p> <p>To change the state of an output pin you may use: <div class=highlight><pre><span></span><code>sensor29 0,ON   // Turn pin ON (HIGH if pinmode 5 or LOW if pinmode 6(inverted))
sensor29 0,OFF  // Turn pin OFF (LOW if pinmode 5 or HIGH if pinmode 6(inverted))
sensor29 0,T    // Toggle the current state of pin from ON to OFF, or OFF to ON
</code></pre></div></p> <p>Additionally all OUTPUT pins will be exposed as RELAYS and ordered behind the normal GPIO based RELAYS. Instead of the above sensor command you can also use the POWERxx command like for any RELAY. If you define INTERLOCK and/or INTERLOCK groups these will also take care about the out pins. The numbering of the RELAY's is following the standard tasmota behavior. Counting from D0 any defined OUT pin will add a new RELAY. Example: D0, D2, D3, D7 are out pins, then D0=POWER1, D2=POWER2, D3=POWER3 and D7=POWER4. Same behavior you can expect when defining PULSETIME for RELAYS.</p> <p>Telemetry response will be provided accordingly, for example: <div class=highlight><pre><span></span><code>MQT: stat/tasmota/RESULT = {&quot;S29cmnd_D0&quot;:{&quot;COMMAND&quot;:&quot;ON&quot;,&quot;STATE&quot;:&quot;ON&quot;}}
MQT: stat/tasmota/RESULT = {&quot;S29cmnd_D0&quot;:{&quot;COMMAND&quot;:&quot;OFF&quot;,&quot;STATE&quot;:&quot;OFF&quot;}}
MQT: stat/tasmota/RESULT = {&quot;S29cmnd_D0&quot;:{&quot;COMMAND&quot;:&quot;TOGGLE&quot;,&quot;STATE&quot;:&quot;ON&quot;}}
</code></pre></div></p> <p><code>COMMAND = Command which was sent</code></p> <p><code>STATE = New state after execution of command</code></p> <p>Telemetry data is provided for pins which are enabled for output. For example, if pin 0 was enabled for OUTPUT the following additional telemetry message will be sent by MQTT at the same time as the normal telemetry interval occurs which reports the current states of pins. Additionally you can also use the standard POWERxx reporting.</p> <div class=highlight><pre><span></span><code>MQT: tele/tasmota/SENSOR = {&quot;Time&quot;:&quot;2018-08-18T16:41:20&quot;,&quot;MCP230XX&quot;:{&quot;D0&quot;:0,&quot;D1&quot;:0,&quot;D2&quot;:1,&quot;D3&quot;:0,&quot;D4&quot;:0,&quot;D5&quot;:0,&quot;D6&quot;:0,&quot;D7&quot;:0},&quot;MCP230_OUT&quot;: {&quot;OUT_D4&quot;:&quot;OFF&quot;,&quot;END&quot;:1}}
</code></pre></div> <p>Note the MCP230XX telemetry which provides the current logic state of all the pins and then the second MQT telemetry as MCP230_OUT which indicates the current state of pins configured for OUTPUT - In this case pin 4 or D4</p> <p>Remember to adhere to the current limitations of OUTPUT pins when using the device for switching external devices such as LED's. That being said most readily available relay pc boards available from vendors are optically isolated from the input so these will work perfectly.</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://discord.gg/Ks2Kzd4 target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg> </a> <a href=https://t.me/tasmota target=_blank rel=noopener title=t.me class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M256 8a248 248 0 1 0 0 496 248 248 0 1 0 0-496m115 168.7c-3.7 39.2-19.9 134.4-28.1 178.3-3.5 18.6-10.3 24.8-16.9 25.4-14.4 1.3-25.3-9.5-39.3-18.7-21.8-14.3-34.2-23.2-55.3-37.2-24.5-16.1-8.6-25 5.3-39.5 3.7-3.8 67.1-61.5 68.3-66.7.2-.7.3-3.1-1.2-4.4s-3.6-.8-5.1-.5c-2.2.5-37.1 23.5-104.6 69.1-9.9 6.8-18.9 10.1-26.9 9.9-8.9-.2-25.9-5-38.6-9.1-15.5-5-27.9-7.7-26.8-16.3.6-4.5 6.7-9 18.4-13.7 72.3-31.5 120.5-52.3 144.6-62.3 68.9-28.6 83.2-33.6 92.5-33.8 2.1 0 6.6.5 9.6 2.9 2 1.7 3.2 4.1 3.5 6.7.5 3.2.6 6.5.4 9.8z"/></svg> </a> <a href=https://github.com/tasmota target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "content.action.edit", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../assets/javascripts/bundle.79ae519e.min.js></script> <script src=https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js></script> <script src=../extra_javascript/tablesort.js></script> </body> </html>